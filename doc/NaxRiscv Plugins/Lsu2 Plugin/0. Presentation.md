Lsu2 Plugin is the load store unit of the NaxRiscv :
- it loads and stores in the cache memory
- it contains the load and store queues used in out-of-order core
- it allocates an entry in these queues for each load/store instruction during the dispatch stage
- it releases entries when instructions are committed
___
#### Introduction

As the NaxRiscv is an out-of-order core, failures can happen with load and store instructions.

Firstly, because we write in cache memory only when store instructions are committed. 
So, if we have a store instruction followed by a load instruction in the order of the programme, and both point to the same address.
If the load instruction is executed before the store instruction is committed, it will load an incorrect value from the cache memory, as it's not the latest value.

We can therefore implement an LSU that waits for the load/store instruction to commit before executing the next load/store instruction, in order to solve our problem.
But this will slow down overall execution and create a bottleneck. Moreover, our problem only arises if we store and load at the same address. 
If we have a store at address A and a load at address B, executing these instructions out of order won't cause any problems.

This is why we use load and store queues in `Lsu2` plugin, which allow us to track load/store instructions in the pipeline between the dispatch stage and the commit stage.
So, when we perform a load, before accessing the cache, we can see in the store queue whether there is a store at the same address that has not been committed. If so, we load the value from that store, it's a **store-to-load forwarding**.

___
#### Load queue

The load queue stores all data about load instructions being processed by the `Lsu2` plugin.
These informations are stored in two parts `regs` and `mem`.

##### Reg fields

The data in `regs` is mainly used for control purposes, such as knowing whether an entry is valid, whether it needs to redo its request, because of what, a cache miss, a TLB miss, etc

For each entry in the load queue, we have the following fields :
- **allocation** : to check whether an entry is allocated
	- set to true during the entry is allocated
	- set to false in all other cases => normally set to true for 1 clock cycle
___
- **valid (reg)** : to check whether an entry is valid
	- set to true when `allocation` = true
	- set to false when `delete` = true
___
- **redo (reg)** : to know whether an entry can be processed by the `Lsu2`
	- set to true when `redoSet` = true
	- set to false when `delete` = true OR when the entry is processed
___
- **redoSet** : used to set the `redo` register to true
	- set to true when the load queue entry that is waiting for a cache refill, MMU refill or older store, receives a completion signal from the pending operation.
	- set to true when `Agu` first pushes the load into `Lsu2`
	- set to false in all other cases => normally set to true for 1 clock cycle
___
- **delete** : to invalidate an entry
	- set to true when the entry is committed OR when `Lsu2` receives a rescheduling command
	- set to false in all other cases => normally set to true for 1 clock cycle
___
- **sqChecked (reg)** : to know whether we have already checked the store queue for older stores at the same address
	- set to true when the `checkSqMask` stage of `sharedPipeline` is triggered
	- set to false when the entry is allocated as register initialisation
___
- **niceHazard (reg)** : Used for hazard prediction
	- set to true when the load processed in `checkLqHits` stage, points to the same address as a newer load allocated since the instruction allocation as a load allocated more recently
___
___
- **address** : 
	- **pageOffset (reg)** : address page offset (64 bits : 11 downto 3) or (32 bits : 11 downto 2)
	- **mask (reg)** : data mask depending on the load instruction(byte, half, word, double)
___
___
- **waitOn** : 
	- **cacheRefill (reg)** : to indicate that we are waiting for a cache refill for this queue entry
		- set to true when `cacheRefillSet` = true OR  `cacheRefill` = true already
		- set to false when `redoSet` = true, this is the case after the cache refill has been completed
	- **cacheRefillAny (reg)** : seems not used always false
	- **mmuRefillAny (reg)** : to indicate that we are waiting for a MMU refill for this queue entry
		- set to true when `mmuRefillAnySet` = true OR  `mmuRefillAny` = true already
		- set to false when `redoSet` = true, this is the case after the MMU refill has been completed
	- **sqWriteback (reg)** : to indicate that we are waiting for the MMU refill for an older store. The store has the same address page offset as the load, but we need the physical address to make sure we're pointing to the same word. Or indicate a load hazard prediction hit.
		- set to true when `sqWritebackSet` = true OR  `sqWriteback` = true already
		- set to false when `redoSet` = true
	- **sqFeed (reg)** : to indicate that we are waiting for the MMU refill for an older store. The store has the same address page offset as the load, but we need the physical address to make sure we're pointing to the same word. OR indicate a load hazard prediction hit.
		- set to true when `sqFeedSet` = true OR  `sqFeed` = true already
		- set to false when `redoSet` = true
	- **sqId (reg)** : the store queue entry ID of the older store or the store which gives the hazard prediction hit

	- **cacheRefillSet** : used to set the `cacheRefill` register to true
		- set to true when the load processed in the `sharedPip` results in a cache miss
		- set to false in all other cases => normally set to true for 1 clock cycle
	- **mmuRefillAnySet** : used to set the `mmuRefillAny` register to true
		- set to true when the load processed in the `sharedPip` results in a TLB miss
		- set to false in all other cases => normally set to true for 1 clock cycle
	- **sqWritebackSet** : used to set the `sqWriteback` register to true
		- set to true when the load processed in the `sharedPip` has the same page offset address as an older store. But this store is waiting for its physical address. OR the load gives an hazard prediction hit.
		- set to false in all other cases => normally set to true for 1 clock cycle
	- **sqFeedSet** : used to set the `sqFeed` register to true
		- set to true when the load processed in the `sharedPip` has the same page offset address as an older store. But this store is waiting for its physical address. OR the load gives an hazard prediction hit.
		- set to false in all other cases => normally set to true for 1 clock cycle

##### Mem fields

For each entry in the load queue, we have the following fields :
- **addressPre** : virtual address
- **addressPost** : physical address
- **size** : load size (byte, half, word, double)
- **physRd** : physical destination register
- **regfileRd** : register file type (Int, Float)
- **writeRd** : true if use a destination register
- **robId** : ROB id
- **robIdMsb** : ROB id msb
- **pc** : program counter
- **sqAlloc** : store queue allocation pointer value when we allocate load queue entry
- **io** : if it's a peripheral load
- **lr** : if it's a LR (load reserved) instruction
- **unsigned** : unsigned load instruction
- **doSpecial** : If we have to go through the `special` area in `Lsu2` plugin, this is the case for the peripheral load accesses.
- **data** : not used
- **needTranslation** : if the load needs an address translation, once the translation is complete, set to False
- **spFpAddress** : If the architectural source register 1 is sp(stack pointer), gp(global pointer) or fp(frame pointer)

- **hazardPrediction** : TODO
	- **valid** : 
	- **delta** : 
	- **score** : 

- **hitPrediction**
	- **counter** : hit score of the load instruction in this queue entry, set when the instruction is pushed by `Agu` with the value stored in the `hitPrediction` memory array (see below)

##### Pointer

The main pointers are in ptr area :
- **alloc** : pointer to the entry in the queue to be allocated.
- **free** : pointer to the queue entry to be released. It is incremented by 1 or 2 (if `COMMIT_COUNT = 2`), when instruction is committed.

- **priority** : mask used by round robin arbiter. Initialised at 0, after the first commit it is set to all 1s, then, after each commit, the LSB equal to 1 is replaced by 0.
So we have :
00...000 -> queue entry 0 committed -> 11...111 -> queue entry 1 committed -> 11...110 
-> queue entry 2 committed -> 11...100

###### Tracker

- **free** : follow number of available entry in the queue
- **add** : used to compute the number of free entry, add is used when we free entry, so to increase free tracker
- **sub** : used to compute the number of free entry, sub is used when we use available entry, so to decrease free tracker

##### Reservation

Used for LR/SC instructions to reserve an address
- **valid** : to know whether an address is reserved
	- set to true by the LR instruction
	- set to false by the SC instruction
- **address** : stores the physical address of the LR instruction

##### hazardPrediction

***TODO***

##### hitPrediction

In this part, there is a memory of 1024 entries indexed by PC and storing the counters (success score) in the form of 2's complement numbers.

In a window of 1024 addresses in a program, we use the score to find out whether a load instruction in this window has already been executed in the recent past, and how many times.
For example, if there is a loop in the program with a load instruction inside it.
If a load instruction has been executed in the recent past, there is a high probability that the load will result in a cache hit, because we are loading the same or a close memory address.

The score is initialised to 0, and by default its range is \[ -31; 31]
Each time a load instruction is executed, and has the same PC :
- if the load was successful (cache hit), the score is decremented by 1, so we get scores of 0, -1, -2, ...
- if the load has failed (cache miss, ...), the score is incremented by `hitPredictionErrorPenality` (20 by default)

When the score is negative, the load instruction is likely to hit, and as explained later in the `hitSpeculation` stage, we send the `wakeRob` and `wakeRf` signals ahead of time, to signal that the instruction has been executed.

___
#### Store queue

The store queue stores all data about store instructions being processed by the `Lsu2` plugin.
These informations are stored in two parts `regs` and `mem`.

##### Reg fields

The data in `regs` is mainly used for control purposes, such as knowing whether an entry is valid, whether it needs to redo its request, because of what, a TLB miss.

For each entry in the store queue, we have the following fields :
- **allocation** : to check whether an entry is allocated
	- set to true during the entry is allocated
	- set to false in all other cases => normally set to true for 1 clock cycle
___
- **valid (reg)** : to check whether an entry is valid
	- set to true when `allocation` = true
	- set to false when `delete` = true
___
- **redo (reg)** : to know whether an entry can be processed by the `Lsu2`
	- set to true when `redoSet` = true
	- set to false when `delete` = true OR when the entry is processed
___
- **redoSet** : used to set the `redo` register to true
	- set to true when the store queue entry that is waiting for a MMU refill, receives a completion signal from this pending operation.
	- set to true when `Agu` first pushes the store into `Lsu2`
	- set to false in all other cases => normally set to true for 1 clock cycle
___
- **delete** : to invalidate an entry
	- set to true when the entry is committed OR when `Lsu2` receives a rescheduling command
	- set to false in all other cases => normally set to true for 1 clock cycle
___
- **dataValid (reg)** : an entry in the store queue contains valid data
	- set to true when the store instruction is pushed from `Agu` to `Lsu2` pipeline
	- set to false when the entry is allocated as register initialisation
___
- **commitedNext** : used to set the `commited` register
	- set to true when the entry is committed
	- set to false when `delete` = true
___
- **commited (reg)** : to check whether an entry is committed
	- set to true when `commitedNext` = true
	- set to false when `commitedNext` = false 
___
___
- **address** : 
	- **pageOffset (reg)** : address page offset (64 bits : 11 downto 3) or (32 bits : 11 downto 2)
	- **mask (reg)** : data mask depending on the store instruction(byte, half, word, double)
___
___
- **waitOn** : 
	- **mmuRefillAny (reg)** : to indicate that we are waiting for a MMU refill for this queue entry
		- set to true when `mmuRefillAnySet` = true OR  `mmuRefillAny` = true already
		- set to false when `redoSet` = true, this is the case after the MMU refill has been completed

	- **mmuRefillAnySet** : used to set the `mmuRefillAny` register to true
		- set to true when the store processed in the `sharedPip` results in a TLB miss
		- set to false in all other cases => normally set to true for 1 clock cycle

##### Mem fields

For each slot in the store queue, we have the following fields :
- **addressPre** : virtual address
- **addressPost** : physical address
- **size** : store size (byte, half, word, double)
- **robId** : ROB id
- **robIdMsb** : ROB id msb
- **lqAlloc** : load queue allocation pointer value when we allocate store queue entry
- **io** : if it's a peripheral store
- **sc** : if it's SR (store reserved) instruction
- **amo** : if it's an atomic operation (AMOADD, AMOXOR, AMOAND, AMOOR, ...)
- **data** : data to store
- **needTranslation** : if the store needs an address translation, once the translation is complete, set to False
- **feededOnce** : To find out whether the store instruction has been entered once in the LSU. It is set to False during allocation and to True once it has been entered into the LSU.
- **doSpecial** : If we have to go through the `special` area in `Lsu2` plugin, this is the case for the SC, atomic operations and peripheral store instructions.
- **doNotBypass** : If we have an atomic or SC operation, a load at the same address that comes after the store must not take the data from this store.  The load must not bypass memory access.

The following fields are stored in registers, so for the whole queue there is 1 register per field.
We do this because the `Lsu2` can only handle one atomic operation (AMO/SC).
- **physRd** : physical destination register
- **regfileRd** : register file type (Int, Float)
- **writeRd** : true if use a destination register
- **swap** : true if it's an atomic swap operation (AMOSWAP)
- **op** : 3-bit field used to identify the type of atomic operation among all the atomic operations except AMOSWAP, LR and SC

##### Pointer

The main pointers are in ptr area :
- **alloc** : pointer to the queue entry to be allocated.
- **commit** : pointer to the queue entry to be committed. It is incremented by 1 or 2 (if `COMMIT_COUNT = 2`), when the instruction is committed.
- **writeback** : pointer to the queue entry to be written back. It is incremented by 1, when the instruction is written back.
- **free** : pointer to the queue entry to be released. It is incremented by 1, when the instruction is written back.

- **priority** : mask used by round robin arbiter. Initialised at 0, after the first commit it is set to all 1s, then, after each commit, the LSB equal to 1 is replaced by 0.
	So we have :
	00...000 -> queue entry 0 committed -> 11...111 -> queue entry 1 committed -> 11...110 
	-> queue entry 2 committed -> 11...100

###### Tracker

- **free** : follow number of available entry in the queue
- **add** : used to compute the number of free entry, add is used when we free entry, so to increase free tracker
- **sub** : used to compute the number of free entry, sub is used when we use available entry, so to decrease free tracker

___
#### Allocation

During `dispatch` stage of `frontend.pipeline`, the following operations are performed.

We know if it's a load or store instruction thanks to `LQ_ALLOC` and `SQ_ALLOC` stageables.
These stageables are set in `DecoderPlugin` thanks to the `addResourceDecoding` function.

As we have added the `LQ` resource to the load instruction type definition `TypeILQ` , and the `SQ` resource to the store instruction type definition `TypeSSQ` , when an instruction using these resources is decoded, we set the associated stageable.

When we allocate a load instruction or a store instruction to its associated queue, we check that the queue is not full. If it is, the dispatch stage of the `frontend.pipeline` is halted.
##### Load

Based on `DISPATCH_MASK` and `LQ_ALLOC`, we know which instructions are valid and are load instructions at dispatch stage.

For each load instruction : 
- We allocate an entry in the load queue and fill in some entry fields
- We fill the associated variables `LQ_ID`, `SQ_ID` with the values of pointers `lq.ptr.alloc`, `sq.ptr.alloc`. As this is a load, `LSU_ID = LQ_ID`. These stageables are written to the associated ROB slot.
- We increment the `lq.ptr.alloc` pointer
- Finally, we decrement the number of available entry in the load queue, by using the pointer `lq.tracker.sub`. We decrement by the number of load instructions during this stage. As `DISPATCH_COUNT = 2`, it can be 0, 1 or 2.

##### Store

Based on `DISPATCH_MASK` and `SQ_ALLOC`, we know which instructions are valid and are store instructions at dispatch stage.

For each store instruction : 
- We allocate an entry in the store queue and fill in some entry fields
- We fill the associated variables `LQ_ID`, `SQ_ID` with the values of pointers `lq.ptr.alloc`, `sq.ptr.alloc`. As this is a store, `LSU_ID = SQ_ID`.  These stageables are written to the associated ROB slot.
- We increment the `sq.ptr.alloc` pointer
- Finally, we decrement the number of available entry in the store queue, by using the pointer `sq.tracker.sub`. We decrement by the number of store instructions during this stage. As `DISPATCH_COUNT = 2`, it can be 0, 1 or 2.

___
#### sharedPip

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 826.8402378926276 826.267578125" width="826.8402378926276" height="826.267578125">
  <!-- svg-source:excalidraw -->
  
  <defs>
    <style class="style-fonts">
      @font-face {
        font-family: "Virgil";
        src: url("https://excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://excalidraw.com/Cascadia.woff2");
      }
    </style>
  </defs>
  <rect x="0" y="0" width="826.8402378926276" height="826.267578125" fill="#ffffff"></rect><g stroke-linecap="round"><g transform="translate(19 78.75) rotate(0 206.5 0)"><path d="M0 0 C108.26 0, 216.53 0, 413 0 M0 0 C104.49 0, 208.97 0, 413 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(19 78.75) rotate(0 206.5 0)"><path d="M413 0 L399.41 6.34 L399.41 -6.34 L413 0" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M413 0 C409.44 1.66, 405.87 3.32, 399.41 6.34 M413 0 C409.56 1.6, 406.12 3.21, 399.41 6.34 M399.41 6.34 C399.41 3.78, 399.41 1.22, 399.41 -6.34 M399.41 6.34 C399.41 1.97, 399.41 -2.39, 399.41 -6.34 M399.41 -6.34 C404.6 -3.92, 409.8 -1.49, 413 0 M399.41 -6.34 C403.86 -4.26, 408.31 -2.19, 413 0 M413 0 C413 0, 413 0, 413 0 M413 0 C413 0, 413 0, 413 0" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(40 58.25) rotate(0 74.5 20.5)"><path d="M10.25 0 L138.75 0 L143.23 0.64 L146.44 2.56 L148.36 5.77 L149 10.25 L149 30.75 L148.36 35.23 L146.44 38.44 L143.23 40.36 L138.75 41 L10.25 41 L5.77 40.36 L2.56 38.44 L0.64 35.23 L0 30.75 L0 10.25 L0.64 5.77 L2.56 2.56 L5.77 0.64 L10.25 0" stroke="none" stroke-width="0" fill="#fab005"></path><path d="M10.25 0 M10.25 0 C44.17 0, 78.1 0, 138.75 0 M10.25 0 C46.04 0, 81.83 0, 138.75 0 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M149 10.25 C149 14.89, 149 19.53, 149 30.75 M149 10.25 C149 15.22, 149 20.2, 149 30.75 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M138.75 41 C92.45 41, 46.15 41, 10.25 41 M138.75 41 C94.33 41, 49.91 41, 10.25 41 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M0 30.75 C0 23.68, 0 16.6, 0 10.25 M0 30.75 C0 24.15, 0 17.56, 0 10.25 M0 10.25 C0 3.42, 3.42 0, 10.25 0 M0 10.25 C0 3.42, 3.42 0, 10.25 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(102 67.25) rotate(0 12.5 11.5)"><text x="12.5" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">S0</text></g><g stroke-linecap="round" transform="translate(245.5 58.25) rotate(0 74.5 20.5)"><path d="M10.25 0 L138.75 0 L143.23 0.64 L146.44 2.56 L148.36 5.77 L149 10.25 L149 30.75 L148.36 35.23 L146.44 38.44 L143.23 40.36 L138.75 41 L10.25 41 L5.77 40.36 L2.56 38.44 L0.64 35.23 L0 30.75 L0 10.25 L0.64 5.77 L2.56 2.56 L5.77 0.64 L10.25 0" stroke="none" stroke-width="0" fill="#fd7e14"></path><path d="M10.25 0 M10.25 0 C41.59 0, 72.93 0, 138.75 0 M10.25 0 C47.07 0, 83.89 0, 138.75 0 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M149 10.25 C149 15.66, 149 21.07, 149 30.75 M149 10.25 C149 15.19, 149 20.13, 149 30.75 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M138.75 41 C98.25 41, 57.75 41, 10.25 41 M138.75 41 C92.8 41, 46.85 41, 10.25 41 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M0 30.75 C0 23.57, 0 16.38, 0 10.25 M0 30.75 C0 26.34, 0 21.93, 0 10.25 M0 10.25 C0 3.42, 3.42 0, 10.25 0 M0 10.25 C0 3.42, 3.42 0, 10.25 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(307.5 67.25) rotate(0 12.5 11.5)"><text x="12.5" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">S1</text></g><g transform="translate(161 19) rotate(0 66 11.5)"><text x="0" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">lqSqArbitration</text></g><g stroke-linecap="round" transform="translate(10 10) rotate(0 217 52.5)"><path d="M0 0 C148.67 0, 297.35 0, 434 0 M0 0 C151.38 0, 302.77 0, 434 0 M434 0 C434 41.4, 434 82.8, 434 105 M434 0 C434 41.78, 434 83.56, 434 105 M434 105 C297.89 105, 161.78 105, 0 105 M434 105 C292.66 105, 151.33 105, 0 105 M0 105 C0 64.33, 0 23.66, 0 0 M0 105 C0 80.56, 0 56.12, 0 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(197 87) rotate(0 21 11.5)"><text x="0" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">M2S</text></g><g stroke-linecap="round"><g transform="translate(324 214.99999999999997) rotate(0 90.57320703524658 229.90140429560185)"><path d="M0 0 C70.5 1.67, 352.33 -6.83, 423 10 C493.67 26.83, 533 81.83, 424 101 C315 120.17, -122.17 88.33, -231 125 C-339.83 161.67, -338 285, -229 321 C-120 357, 314.33 319.5, 423 341 C531.67 362.5, 499.17 430.67, 423 450 C346.83 469.33, 42.17 455.83, -34 457 M0 0 C70.5 1.67, 352.33 -6.83, 423 10 C493.67 26.83, 533 81.83, 424 101 C315 120.17, -122.17 88.33, -231 125 C-339.83 161.67, -338 285, -229 321 C-120 357, 314.33 319.5, 423 341 C531.67 362.5, 499.17 430.67, 423 450 C346.83 469.33, 42.17 455.83, -34 457" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(324 214.99999999999997) rotate(0 90.57320703524658 229.90140429560185)"><path d="M-34 457 L-20.32 450.85 L-20.49 463.53 L-34 457" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M-34 457 C-31.18 455.73, -28.37 454.47, -20.32 450.85 M-34 457 C-28.77 454.65, -23.53 452.29, -20.32 450.85 M-20.32 450.85 C-20.37 454.8, -20.43 458.76, -20.49 463.53 M-20.32 450.85 C-20.36 453.74, -20.4 456.62, -20.49 463.53 M-20.49 463.53 C-23.2 462.22, -25.91 460.91, -34 457 M-20.49 463.53 C-25.28 461.21, -30.06 458.9, -34 457 M-34 457 C-34 457, -34 457, -34 457 M-34 457 C-34 457, -34 457, -34 457" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(349.5 194.5) rotate(0 74.5 20.5)"><path d="M10.25 0 L138.75 0 L143.23 0.64 L146.44 2.56 L148.36 5.77 L149 10.25 L149 30.75 L148.36 35.23 L146.44 38.44 L143.23 40.36 L138.75 41 L10.25 41 L5.77 40.36 L2.56 38.44 L0.64 35.23 L0 30.75 L0 10.25 L0.64 5.77 L2.56 2.56 L5.77 0.64 L10.25 0" stroke="none" stroke-width="0" fill="#82c91e"></path><path d="M10.25 0 M10.25 0 C52.88 0, 95.5 0, 138.75 0 M10.25 0 C59.01 0, 107.76 0, 138.75 0 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M149 10.25 C149 16, 149 21.76, 149 30.75 M149 10.25 C149 15.56, 149 20.87, 149 30.75 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M138.75 41 C94.32 41, 49.9 41, 10.25 41 M138.75 41 C89.1 41, 39.45 41, 10.25 41 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M0 30.75 C0 26.05, 0 21.35, 0 10.25 M0 30.75 C0 26.26, 0 21.76, 0 10.25 M0 10.25 C0 3.42, 3.42 0, 10.25 0 M0 10.25 C0 3.42, 3.42 0, 10.25 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(404 203.5) rotate(0 20 11.5)"><text x="20" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">feed</text></g><g stroke-linecap="round" transform="translate(548.5 194.5) rotate(0 74.5 20.5)"><path d="M10.25 0 L138.75 0 L143.23 0.64 L146.44 2.56 L148.36 5.77 L149 10.25 L149 30.75 L148.36 35.23 L146.44 38.44 L143.23 40.36 L138.75 41 L10.25 41 L5.77 40.36 L2.56 38.44 L0.64 35.23 L0 30.75 L0 10.25 L0.64 5.77 L2.56 2.56 L5.77 0.64 L10.25 0" stroke="none" stroke-width="0" fill="#82c91e"></path><path d="M10.25 0 M10.25 0 C39.6 0, 68.95 0, 138.75 0 M10.25 0 C45.47 0, 80.68 0, 138.75 0 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M149 10.25 C149 14.79, 149 19.34, 149 30.75 M149 10.25 C149 15.06, 149 19.87, 149 30.75 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M138.75 41 C100.19 41, 61.64 41, 10.25 41 M138.75 41 C108.32 41, 77.89 41, 10.25 41 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M0 30.75 C0 22.88, 0 15, 0 10.25 M0 30.75 C0 22.96, 0 15.17, 0 10.25 M0 10.25 C0 3.42, 3.42 0, 10.25 0 M0 10.25 C0 3.42, 3.42 0, 10.25 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(559.5 203.5) rotate(0 63.5 11.5)"><text x="63.5" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">hitSpeculation</text></g><g stroke-linecap="round" transform="translate(549.5 304) rotate(0 74.5 20.5)"><path d="M10.25 0 L138.75 0 L143.23 0.64 L146.44 2.56 L148.36 5.77 L149 10.25 L149 30.75 L148.36 35.23 L146.44 38.44 L143.23 40.36 L138.75 41 L10.25 41 L5.77 40.36 L2.56 38.44 L0.64 35.23 L0 30.75 L0 10.25 L0.64 5.77 L2.56 2.56 L5.77 0.64 L10.25 0" stroke="none" stroke-width="0" fill="#82c91e"></path><path d="M10.25 0 M10.25 0 C44.29 0, 78.34 0, 138.75 0 M10.25 0 C43.26 0, 76.28 0, 138.75 0 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M149 10.25 C149 16.16, 149 22.07, 149 30.75 M149 10.25 C149 14.76, 149 19.27, 149 30.75 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M138.75 41 C95.18 41, 51.61 41, 10.25 41 M138.75 41 C109.27 41, 79.8 41, 10.25 41 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M0 30.75 C0 26.39, 0 22.03, 0 10.25 M0 30.75 C0 24.73, 0 18.71, 0 10.25 M0 10.25 C0 3.42, 3.42 0, 10.25 0 M0 10.25 C0 3.42, 3.42 0, 10.25 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(575 313) rotate(0 49 11.5)"><text x="49" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">feedCache</text></g><g stroke-linecap="round" transform="translate(345.5 304) rotate(0 78.5 20.5)"><path d="M10.25 0 L146.75 0 L151.23 0.64 L154.44 2.56 L156.36 5.77 L157 10.25 L157 30.75 L156.36 35.23 L154.44 38.44 L151.23 40.36 L146.75 41 L10.25 41 L5.77 40.36 L2.56 38.44 L0.64 35.23 L0 30.75 L0 10.25 L0.64 5.77 L2.56 2.56 L5.77 0.64 L10.25 0" stroke="none" stroke-width="0" fill="#40c057"></path><path d="M10.25 0 M10.25 0 C52.07 0, 93.89 0, 146.75 0 M10.25 0 C55.56 0, 100.87 0, 146.75 0 M146.75 0 C153.58 0, 157 3.42, 157 10.25 M146.75 0 C153.58 0, 157 3.42, 157 10.25 M157 10.25 C157 17.23, 157 24.21, 157 30.75 M157 10.25 C157 18.14, 157 26.04, 157 30.75 M157 30.75 C157 37.58, 153.58 41, 146.75 41 M157 30.75 C157 37.58, 153.58 41, 146.75 41 M146.75 41 C98.51 41, 50.27 41, 10.25 41 M146.75 41 C117.15 41, 87.56 41, 10.25 41 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M0 30.75 C0 25.48, 0 20.2, 0 10.25 M0 30.75 C0 24.67, 0 18.59, 0 10.25 M0 10.25 C0 3.42, 3.42 0, 10.25 0 M0 10.25 C0 3.42, 3.42 0, 10.25 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(355 313) rotate(0 69 11.5)"><text x="69" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">feedTranslation</text></g><g stroke-linecap="round" transform="translate(148.5 304) rotate(0 74.5 20.5)"><path d="M10.25 0 L138.75 0 L143.23 0.64 L146.44 2.56 L148.36 5.77 L149 10.25 L149 30.75 L148.36 35.23 L146.44 38.44 L143.23 40.36 L138.75 41 L10.25 41 L5.77 40.36 L2.56 38.44 L0.64 35.23 L0 30.75 L0 10.25 L0.64 5.77 L2.56 2.56 L5.77 0.64 L10.25 0" stroke="none" stroke-width="0" fill="#40c057"></path><path d="M10.25 0 M10.25 0 C48.7 0, 87.15 0, 138.75 0 M10.25 0 C55.36 0, 100.47 0, 138.75 0 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M149 10.25 C149 15.05, 149 19.84, 149 30.75 M149 10.25 C149 14.75, 149 19.26, 149 30.75 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M138.75 41 C95.41 41, 52.08 41, 10.25 41 M138.75 41 C96.66 41, 54.57 41, 10.25 41 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M0 30.75 C0 25.25, 0 19.75, 0 10.25 M0 30.75 C0 22.67, 0 14.6, 0 10.25 M0 10.25 C0 3.42, 3.42 0, 10.25 0 M0 10.25 C0 3.42, 3.42 0, 10.25 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(160.5 313) rotate(0 62.5 11.5)"><text x="62.5" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">checkSqMask</text></g><g stroke-linecap="round" transform="translate(148.5 529) rotate(0 74.5 20.5)"><path d="M10.25 0 L138.75 0 L143.23 0.64 L146.44 2.56 L148.36 5.77 L149 10.25 L149 30.75 L148.36 35.23 L146.44 38.44 L143.23 40.36 L138.75 41 L10.25 41 L5.77 40.36 L2.56 38.44 L0.64 35.23 L0 30.75 L0 10.25 L0.64 5.77 L2.56 2.56 L5.77 0.64 L10.25 0" stroke="none" stroke-width="0" fill="#40c057"></path><path d="M10.25 0 M10.25 0 C40.31 0, 70.37 0, 138.75 0 M10.25 0 C52.07 0, 93.9 0, 138.75 0 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M149 10.25 C149 15, 149 19.75, 149 30.75 M149 10.25 C149 15.89, 149 21.52, 149 30.75 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M138.75 41 C92.94 41, 47.14 41, 10.25 41 M138.75 41 C110.89 41, 83.03 41, 10.25 41 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M0 30.75 C0 25.55, 0 20.34, 0 10.25 M0 30.75 C0 25.17, 0 19.6, 0 10.25 M0 10.25 C0 3.42, 3.42 0, 10.25 0 M0 10.25 C0 3.42, 3.42 0, 10.25 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(168 538) rotate(0 55 11.5)"><text x="55" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">checkLqHits</text></g><g stroke-linecap="round" transform="translate(350.5 529) rotate(0 74.5 20.5)"><path d="M10.25 0 L138.75 0 L143.23 0.64 L146.44 2.56 L148.36 5.77 L149 10.25 L149 30.75 L148.36 35.23 L146.44 38.44 L143.23 40.36 L138.75 41 L10.25 41 L5.77 40.36 L2.56 38.44 L0.64 35.23 L0 30.75 L0 10.25 L0.64 5.77 L2.56 2.56 L5.77 0.64 L10.25 0" stroke="none" stroke-width="0" fill="#12b886"></path><path d="M10.25 0 M10.25 0 C55.95 0, 101.66 0, 138.75 0 M10.25 0 C44.48 0, 78.7 0, 138.75 0 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M149 10.25 C149 16.61, 149 22.98, 149 30.75 M149 10.25 C149 15.6, 149 20.96, 149 30.75 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M138.75 41 C102.59 41, 66.42 41, 10.25 41 M138.75 41 C97.93 41, 57.1 41, 10.25 41 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M0 30.75 C0 24.02, 0 17.28, 0 10.25 M0 30.75 C0 24.24, 0 17.72, 0 10.25 M0 10.25 C0 3.42, 3.42 0, 10.25 0 M0 10.25 C0 3.42, 3.42 0, 10.25 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(368.5 538) rotate(0 56.5 11.5)"><text x="56.5" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">checkSqArbi</text></g><g stroke-linecap="round" transform="translate(549.5 529) rotate(0 74.5 20.5)"><path d="M10.25 0 L138.75 0 L143.23 0.64 L146.44 2.56 L148.36 5.77 L149 10.25 L149 30.75 L148.36 35.23 L146.44 38.44 L143.23 40.36 L138.75 41 L10.25 41 L5.77 40.36 L2.56 38.44 L0.64 35.23 L0 30.75 L0 10.25 L0.64 5.77 L2.56 2.56 L5.77 0.64 L10.25 0" stroke="none" stroke-width="0" fill="#12b886"></path><path d="M10.25 0 M10.25 0 C49.99 0, 89.74 0, 138.75 0 M10.25 0 C37.37 0, 64.49 0, 138.75 0 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M149 10.25 C149 18, 149 25.75, 149 30.75 M149 10.25 C149 15.69, 149 21.14, 149 30.75 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M138.75 41 C88.49 41, 38.23 41, 10.25 41 M138.75 41 C103.43 41, 68.11 41, 10.25 41 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M0 30.75 C0 25.73, 0 20.72, 0 10.25 M0 30.75 C0 25.49, 0 20.23, 0 10.25 M0 10.25 C0 3.42, 3.42 0, 10.25 0 M0 10.25 C0 3.42, 3.42 0, 10.25 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(568.5 538) rotate(0 55.5 11.5)"><text x="55.5" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">checkLqPrio</text></g><g stroke-linecap="round" transform="translate(549.5 651.5) rotate(0 74.5 20.5)"><path d="M10.25 0 L138.75 0 L143.23 0.64 L146.44 2.56 L148.36 5.77 L149 10.25 L149 30.75 L148.36 35.23 L146.44 38.44 L143.23 40.36 L138.75 41 L10.25 41 L5.77 40.36 L2.56 38.44 L0.64 35.23 L0 30.75 L0 10.25 L0.64 5.77 L2.56 2.56 L5.77 0.64 L10.25 0" stroke="none" stroke-width="0" fill="#12b886"></path><path d="M10.25 0 M10.25 0 C44.08 0, 77.91 0, 138.75 0 M10.25 0 C61.64 0, 113.03 0, 138.75 0 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M149 10.25 C149 15.33, 149 20.41, 149 30.75 M149 10.25 C149 17.19, 149 24.12, 149 30.75 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M138.75 41 C109.08 41, 79.41 41, 10.25 41 M138.75 41 C90.18 41, 41.61 41, 10.25 41 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M0 30.75 C0 23.57, 0 16.4, 0 10.25 M0 30.75 C0 24.39, 0 18.04, 0 10.25 M0 10.25 C0 3.42, 3.42 0, 10.25 0 M0 10.25 C0 3.42, 3.42 0, 10.25 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(579.5 660.5) rotate(0 44.5 11.5)"><text x="44.5" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">cacheRsp</text></g><g stroke-linecap="round" transform="translate(350.5 651.5) rotate(0 74.5 20.5)"><path d="M10.25 0 L138.75 0 L143.23 0.64 L146.44 2.56 L148.36 5.77 L149 10.25 L149 30.75 L148.36 35.23 L146.44 38.44 L143.23 40.36 L138.75 41 L10.25 41 L5.77 40.36 L2.56 38.44 L0.64 35.23 L0 30.75 L0 10.25 L0.64 5.77 L2.56 2.56 L5.77 0.64 L10.25 0" stroke="none" stroke-width="0" fill="#12c0b0"></path><path d="M10.25 0 M10.25 0 C44.95 0, 79.66 0, 138.75 0 M10.25 0 C36.95 0, 63.64 0, 138.75 0 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M138.75 0 C145.58 0, 149 3.42, 149 10.25 M149 10.25 C149 16.83, 149 23.4, 149 30.75 M149 10.25 C149 16.55, 149 22.85, 149 30.75 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M149 30.75 C149 37.58, 145.58 41, 138.75 41 M138.75 41 C100.62 41, 62.48 41, 10.25 41 M138.75 41 C92.95 41, 47.14 41, 10.25 41 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M10.25 41 C3.42 41, 0 37.58, 0 30.75 M0 30.75 C0 22.85, 0 14.95, 0 10.25 M0 30.75 C0 24.67, 0 18.6, 0 10.25 M0 10.25 C0 3.42, 3.42 0, 10.25 0 M0 10.25 C0 3.42, 3.42 0, 10.25 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(411 660.5) rotate(0 14 11.5)"><text x="14" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">ctrl</text></g><g stroke-linecap="round" transform="translate(597 23) rotate(0 65.5 36)"><path d="M0 0 C28.18 0, 56.37 0, 131 0 M0 0 C36.84 0, 73.67 0, 131 0 M131 0 C131 27.22, 131 54.45, 131 72 M131 0 C131 17.75, 131 35.49, 131 72 M131 72 C85.02 72, 39.05 72, 0 72 M131 72 C99.18 72, 67.36 72, 0 72 M0 72 C0 48.39, 0 24.79, 0 0 M0 72 C0 48.96, 0 25.93, 0 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(613.5 47.5) rotate(0 49 11.5)"><text x="49" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">Agu Plugin</text></g><g stroke-linecap="round" transform="translate(185.5 396.5) rotate(0 65.5 36)"><path d="M0 0 C31.68 0, 63.37 0, 131 0 M0 0 C42.33 0, 84.66 0, 131 0 M131 0 C131 26.94, 131 53.88, 131 72 M131 0 C131 27.03, 131 54.07, 131 72 M131 72 C102.1 72, 73.2 72, 0 72 M131 72 C101.38 72, 71.76 72, 0 72 M0 72 C0 51.54, 0 31.08, 0 0 M0 72 C0 44.1, 0 16.19, 0 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(197.5 409.5) rotate(0 53.5 23)"><text x="53.5" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">DataCache </text><text x="53.5" y="41" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">Plugin</text></g><g stroke-linecap="round" transform="translate(481.5 396.5) rotate(0 65.5 36)"><path d="M0 0 C45.68 0, 91.35 0, 131 0 M0 0 C37.02 0, 74.03 0, 131 0 M131 0 C131 15.45, 131 30.9, 131 72 M131 0 C131 15.26, 131 30.51, 131 72 M131 72 C102.56 72, 74.12 72, 0 72 M131 72 C97.26 72, 63.52 72, 0 72 M0 72 C0 43.65, 0 15.3, 0 0 M0 72 C0 54.95, 0 37.91, 0 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(493.5 409.5) rotate(0 53.5 23)"><text x="53.5" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">DataCache </text><text x="53.5" y="41" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">Plugin</text></g><g stroke-linecap="round"><g transform="translate(318 100) rotate(0 36.5 45.5)"><path d="M0 0 C0 14.01, 0 28.02, 0 35.82 M0 0 C0 9.11, 0 18.21, 0 35.82 M0 35.82 C19.52 35.82, 39.03 35.82, 73 35.82 M0 35.82 C21.13 35.82, 42.27 35.82, 73 35.82 M73 35.82 C73 50.35, 73 64.88, 73 91 M73 35.82 C73 47.76, 73 59.7, 73 91" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(318 100) rotate(0 36.5 45.5)"><path d="M73 91 L66.66 77.41 L79.34 77.41 L73 91" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M73 91 C70.52 85.68, 68.04 80.36, 66.66 77.41 M73 91 C71.39 87.54, 69.78 84.09, 66.66 77.41 M66.66 77.41 C70.05 77.41, 73.44 77.41, 79.34 77.41 M66.66 77.41 C70.33 77.41, 74 77.41, 79.34 77.41 M79.34 77.41 C77.67 80.99, 76 84.56, 73 91 M79.34 77.41 C77.97 80.35, 76.6 83.29, 73 91 M73 91 C73 91, 73 91, 73 91 M73 91 C73 91, 73 91, 73 91" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(662 95) rotate(0 -101.5 48)"><path d="M0 0 C0 9, 0 18, 0 40.16 M0 0 C0 9.05, 0 18.1, 0 40.16 M0 40.16 C-75.98 40.53, -151.96 40.9, -203 41.14 M0 40.16 C-64.37 40.47, -128.75 40.78, -203 41.14 M-203 41.14 C-203 61.17, -203 81.2, -203 96 M-203 41.14 C-203 57.92, -203 74.71, -203 96" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(662 95) rotate(0 -101.5 48)"><path d="M-203 96 L-209.34 82.41 L-196.66 82.41 L-203 96" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M-203 96 C-204.42 92.95, -205.84 89.91, -209.34 82.41 M-203 96 C-204.43 92.94, -205.86 89.87, -209.34 82.41 M-209.34 82.41 C-204.59 82.41, -199.85 82.41, -196.66 82.41 M-209.34 82.41 C-205.32 82.41, -201.3 82.41, -196.66 82.41 M-196.66 82.41 C-198.98 87.37, -201.29 92.33, -203 96 M-196.66 82.41 C-198.6 86.56, -200.54 90.72, -203 96 M-203 96 C-203 96, -203 96, -203 96 M-203 96 C-203 96, -203 96, -203 96" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(374 347) rotate(0 -27.5 44)"><path d="M0 0 C0 27.7, 0 55.41, 0 88 M0 0 C0 24.39, 0 48.78, 0 88 M0 88 C-17.25 88, -34.5 88, -55 88 M0 88 C-17.55 88, -35.09 88, -55 88" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(374 347) rotate(0 -27.5 44)"><path d="M-55 88 L-41.41 81.66 L-41.41 94.34 L-55 88" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M-55 88 C-50.72 86, -46.44 84.01, -41.41 81.66 M-55 88 C-51.23 86.24, -47.46 84.49, -41.41 81.66 M-41.41 81.66 C-41.41 85.64, -41.41 89.61, -41.41 94.34 M-41.41 81.66 C-41.41 85.71, -41.41 89.75, -41.41 94.34 M-41.41 94.34 C-45.35 92.5, -49.29 90.66, -55 88 M-41.41 94.34 C-46.07 92.16, -50.74 89.99, -55 88 M-55 88 C-55 88, -55 88, -55 88 M-55 88 C-55 88, -55 88, -55 88" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(665 347) rotate(0 -25 44)"><path d="M0 0 C0 33.72, 0 67.43, 0 88 M0 0 C0 34, 0 68, 0 88 M0 88 C-16.74 88, -33.48 88, -50 88 M0 88 C-16.34 88, -32.67 88, -50 88" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(665 347) rotate(0 -25 44)"><path d="M-50 88 L-36.41 81.66 L-36.41 94.34 L-50 88" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M-50 88 C-44.79 85.57, -39.58 83.14, -36.41 81.66 M-50 88 C-44.75 85.55, -39.49 83.1, -36.41 81.66 M-36.41 81.66 C-36.41 85.91, -36.41 90.15, -36.41 94.34 M-36.41 81.66 C-36.41 85.8, -36.41 89.95, -36.41 94.34 M-36.41 94.34 C-39.29 92.99, -42.18 91.65, -50 88 M-36.41 94.34 C-40.71 92.33, -45.01 90.32, -50 88 M-50 88 C-50 88, -50 88, -50 88 M-50 88 C-50 88, -50 88, -50 88" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g transform="translate(675 381.5) rotate(0 57 9)"><text x="0" y="14" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">cacheLoad.cmd</text></g><g transform="translate(384 363) rotate(0 77 9)"><text x="0" y="14" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">cacheLoad.translated</text></g><g transform="translate(215 203) rotate(0 46.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">sharedPip</text></g><g transform="translate(675 108) rotate(0 68.5 9)"><text x="0" y="14" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">aguPorts.head.port</text></g><g stroke-linecap="round" transform="translate(38.18323842617815 127.55293282549303) rotate(0 52.5 20.5)"><path d="M105 20.5 C105 21.47, 104.82 22.45, 104.47 23.42 C104.11 24.38, 103.58 25.34, 102.87 26.28 C102.17 27.21, 101.29 28.13, 100.26 29.02 C99.22 29.9, 98.01 30.77, 96.67 31.58 C95.32 32.4, 93.81 33.19, 92.18 33.92 C90.55 34.66, 88.76 35.36, 86.88 35.99 C85 36.63, 82.98 37.22, 80.88 37.75 C78.79 38.27, 76.57 38.74, 74.31 39.15 C72.04 39.55, 69.68 39.9, 67.29 40.17 C64.9 40.44, 62.44 40.65, 59.97 40.79 C57.51 40.93, 54.99 41, 52.5 41 C50.01 41, 47.49 40.93, 45.03 40.79 C42.56 40.65, 40.1 40.44, 37.71 40.17 C35.32 39.9, 32.96 39.55, 30.69 39.15 C28.43 38.74, 26.21 38.27, 24.12 37.75 C22.02 37.22, 20 36.63, 18.12 35.99 C16.24 35.36, 14.45 34.66, 12.82 33.92 C11.19 33.19, 9.68 32.4, 8.33 31.58 C6.99 30.77, 5.78 29.9, 4.74 29.02 C3.71 28.13, 2.83 27.21, 2.13 26.28 C1.42 25.34, 0.89 24.38, 0.53 23.42 C0.18 22.45, 0 21.47, 0 20.5 C0 19.53, 0.18 18.55, 0.53 17.58 C0.89 16.62, 1.42 15.66, 2.13 14.72 C2.83 13.79, 3.71 12.87, 4.74 11.98 C5.78 11.1, 6.99 10.23, 8.33 9.42 C9.68 8.6, 11.19 7.81, 12.82 7.08 C14.45 6.34, 16.24 5.64, 18.12 5.01 C20 4.37, 22.02 3.78, 24.12 3.25 C26.21 2.73, 28.43 2.26, 30.69 1.85 C32.96 1.45, 35.32 1.1, 37.71 0.83 C40.1 0.56, 42.56 0.35, 45.03 0.21 C47.49 0.07, 50.01 0, 52.5 0 C54.99 0, 57.51 0.07, 59.97 0.21 C62.44 0.35, 64.9 0.56, 67.29 0.83 C69.68 1.1, 72.04 1.45, 74.31 1.85 C76.57 2.26, 78.79 2.73, 80.88 3.25 C82.98 3.78, 85 4.37, 86.88 5.01 C88.76 5.64, 90.55 6.34, 92.18 7.08 C93.81 7.81, 95.32 8.6, 96.67 9.42 C98.01 10.23, 99.22 11.1, 100.26 11.98 C101.29 12.87, 102.17 13.79, 102.87 14.72 C103.58 15.66, 104.11 16.62, 104.47 17.58 C104.82 18.55, 104.91 20.01, 105 20.5 C105.09 20.99, 105.09 20.01, 105 20.5" stroke="none" stroke-width="0" fill="#ffffff"></path><path d="M105 20.5 C105 21.47, 104.82 22.45, 104.47 23.42 C104.11 24.38, 103.58 25.34, 102.87 26.28 C102.17 27.21, 101.29 28.13, 100.26 29.02 C99.22 29.9, 98.01 30.77, 96.67 31.58 C95.32 32.4, 93.81 33.19, 92.18 33.92 C90.55 34.66, 88.76 35.36, 86.88 35.99 C85 36.63, 82.98 37.22, 80.88 37.75 C78.79 38.27, 76.57 38.74, 74.31 39.15 C72.04 39.55, 69.68 39.9, 67.29 40.17 C64.9 40.44, 62.44 40.65, 59.97 40.79 C57.51 40.93, 54.99 41, 52.5 41 C50.01 41, 47.49 40.93, 45.03 40.79 C42.56 40.65, 40.1 40.44, 37.71 40.17 C35.32 39.9, 32.96 39.55, 30.69 39.15 C28.43 38.74, 26.21 38.27, 24.12 37.75 C22.02 37.22, 20 36.63, 18.12 35.99 C16.24 35.36, 14.45 34.66, 12.82 33.92 C11.19 33.19, 9.68 32.4, 8.33 31.58 C6.99 30.77, 5.78 29.9, 4.74 29.02 C3.71 28.13, 2.83 27.21, 2.13 26.28 C1.42 25.34, 0.89 24.38, 0.53 23.42 C0.18 22.45, 0 21.47, 0 20.5 C0 19.53, 0.18 18.55, 0.53 17.58 C0.89 16.62, 1.42 15.66, 2.13 14.72 C2.83 13.79, 3.71 12.87, 4.74 11.98 C5.78 11.1, 6.99 10.23, 8.33 9.42 C9.68 8.6, 11.19 7.81, 12.82 7.08 C14.45 6.34, 16.24 5.64, 18.12 5.01 C20 4.37, 22.02 3.78, 24.12 3.25 C26.21 2.73, 28.43 2.26, 30.69 1.85 C32.96 1.45, 35.32 1.1, 37.71 0.83 C40.1 0.56, 42.56 0.35, 45.03 0.21 C47.49 0.07, 50.01 0, 52.5 0 C54.99 0, 57.51 0.07, 59.97 0.21 C62.44 0.35, 64.9 0.56, 67.29 0.83 C69.68 1.1, 72.04 1.45, 74.31 1.85 C76.57 2.26, 78.79 2.73, 80.88 3.25 C82.98 3.78, 85 4.37, 86.88 5.01 C88.76 5.64, 90.55 6.34, 92.18 7.08 C93.81 7.81, 95.32 8.6, 96.67 9.42 C98.01 10.23, 99.22 11.1, 100.26 11.98 C101.29 12.87, 102.17 13.79, 102.87 14.72 C103.58 15.66, 104.11 16.62, 104.47 17.58 C104.82 18.55, 104.91 20.01, 105 20.5 C105.09 20.99, 105.09 20.01, 105 20.5" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(38.18323842617815 148.55293282549303) rotate(0 0 45.5)"><path d="M0 0 C0 26.95, 0 53.91, 0 91 M0 0 C0 30.54, 0 61.07, 0 91" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(143.18323842617815 149.05293282549303) rotate(0 0 45.5)"><path d="M0 0 C0 32.97, 0 65.95, 0 91 M0 0 C0 24.31, 0 48.61, 0 91" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(38.38482197307383 240.45874301573429) rotate(0 52.499999999999886 8.158224767881222)"><path d="M0 0 C2.62 1.75, 7.13 7.74, 15.73 10.48 C24.33 13.21, 39.26 16.48, 51.59 16.39 C63.91 16.3, 80.8 12.66, 89.7 9.92 C98.6 7.17, 102.45 1.59, 105 -0.08 M0 0 C2.62 1.75, 7.13 7.74, 15.73 10.48 C24.33 13.21, 39.26 16.48, 51.59 16.39 C63.91 16.3, 80.8 12.66, 89.7 9.92 C98.6 7.17, 102.45 1.59, 105 -0.08" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g transform="translate(59.11026945911556 183.33180519106838) rotate(0 33.5 23)"><text x="33.5" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">lqMem</text><text x="33.5" y="41" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">sqMem</text></g><g stroke-linecap="round"><g transform="translate(88.96057363412058 257.73945958517515) rotate(0 151.49511329967635 1.5577828116518901)"><path d="M0 0 C0 5.83, 0 11.66, 0 23.14 M0 0 C0 8.64, 0 17.29, 0 23.14 M0 23.14 C88.02 23.12, 176.05 23.11, 302.99 23.08 M0 23.14 C101.34 23.12, 202.69 23.1, 302.99 23.08 M302.99 23.08 C302.99 13.58, 302.99 4.07, 302.99 -20.03 M302.99 23.08 C302.99 7.28, 302.99 -8.53, 302.99 -20.03" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(88.96057363412058 257.73945958517515) rotate(0 151.49511329967635 1.5577828116518901)"><path d="M302.99 -20.03 L309.33 -6.43 L296.65 -6.43 L302.99 -20.03" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M302.99 -20.03 C304.59 -16.6, 306.18 -13.18, 309.33 -6.43 M302.99 -20.03 C305.36 -14.95, 307.73 -9.87, 309.33 -6.43 M309.33 -6.43 C305.65 -6.43, 301.96 -6.43, 296.65 -6.43 M309.33 -6.43 C305.09 -6.43, 300.85 -6.43, 296.65 -6.43 M296.65 -6.43 C298.05 -9.43, 299.45 -12.43, 302.99 -20.03 M296.65 -6.43 C298.98 -11.42, 301.3 -16.4, 302.99 -20.03 M302.99 -20.03 C302.99 -20.03, 302.99 -20.03, 302.99 -20.03 M302.99 -20.03 C302.99 -20.03, 302.99 -20.03, 302.99 -20.03" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g transform="translate(206.756656221752 139.25308381206617) rotate(0 24.5 18)"><text x="24.5" y="14" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">LQ_ID</text><text x="24.5" y="32" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">SQ_ID</text></g><g stroke-linecap="round"><g transform="translate(318.18359159781494 135.57396476638615) rotate(0 -85.92476275338032 24.36672376588396)"><path d="M0 0 C0 13.7, 0 27.39, 0 48.73 M0 0 C0 12.99, 0 25.98, 0 48.73 M0 48.73 C-38.18 48.73, -76.37 48.73, -171.85 48.73 M0 48.73 C-56.24 48.73, -112.47 48.73, -171.85 48.73" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(318.18359159781494 135.57396476638615) rotate(0 -85.92476275338032 24.36672376588396)"><path d="M-171.85 48.73 L-158.25 42.39 L-158.25 55.07 L-171.85 48.73" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M-171.85 48.73 C-168.03 46.95, -164.21 45.17, -158.25 42.39 M-171.85 48.73 C-168.23 47.04, -164.6 45.35, -158.25 42.39 M-158.25 42.39 C-158.25 45.21, -158.25 48.03, -158.25 55.07 M-158.25 42.39 C-158.25 46.54, -158.25 50.69, -158.25 55.07 M-158.25 55.07 C-161.66 53.48, -165.07 51.89, -171.85 48.73 M-158.25 55.07 C-161.26 53.67, -164.26 52.27, -171.85 48.73 M-171.85 48.73 C-171.85 48.73, -171.85 48.73, -171.85 48.73 M-171.85 48.73 C-171.85 48.73, -171.85 48.73, -171.85 48.73" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(440.9201189463138 744.267578125) rotate(0 65.5 36)"><path d="M0 0 C32.31 0, 64.62 0, 131 0 M0 0 C46.2 0, 92.4 0, 131 0 M131 0 C131 19.96, 131 39.93, 131 72 M131 0 C131 22.38, 131 44.76, 131 72 M131 72 C97.21 72, 63.42 72, 0 72 M131 72 C89.95 72, 48.89 72, 0 72 M0 72 C0 53.9, 0 35.8, 0 0 M0 72 C0 51.16, 0 30.33, 0 0" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(452.9201189463138 757.267578125) rotate(0 53.5 23)"><text x="53.5" y="18" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">DataCache </text><text x="53.5" y="41" font-family="Helvetica, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">Plugin</text></g><g stroke-linecap="round"><g transform="translate(624.4201189463138 694.767578125) rotate(0 -25 44)"><path d="M0 0 C0 25.22, 0 50.45, 0 88 M0 0 C0 28.61, 0 57.21, 0 88 M0 88 C-19.66 88, -39.32 88, -50 88 M0 88 C-16.88 88, -33.76 88, -50 88" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(624.4201189463138 694.767578125) rotate(0 -25 44)"><path d="M0 0 L6.34 13.59 L-6.34 13.59 L0 0" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M0 0 C1.82 3.9, 3.63 7.79, 6.34 13.59 M0 0 C2.06 4.42, 4.12 8.84, 6.34 13.59 M6.34 13.59 C1.35 13.59, -3.63 13.59, -6.34 13.59 M6.34 13.59 C2.06 13.59, -2.22 13.59, -6.34 13.59 M-6.34 13.59 C-4.1 8.79, -1.86 3.99, 0 0 M-6.34 13.59 C-4.45 9.55, -2.57 5.5, 0 0 M0 0 C0 0, 0 0, 0 0 M0 0 C0 0, 0 0, 0 0" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g transform="translate(634.4201189463138 729.267578125) rotate(0 53 9)"><text x="0" y="14" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">cacheLoad.rsp</text></g></svg>
  
The main pipeline of `Lsu2` plugin has the following states :

##### feed
> by default stage 0

As the name suggests, this stage feeds the pipeline with an instruction either from `Agu` for a new one, or from `lqSqArbitration` if it needs to be redone and is ready.
If two instructions arrive, the instruction from `lqSqArbitration` takes precedence over the new instruction from `Agu`.

###### Stageables

- `TAKE_LQ` : used for instructions from`lqSqArbitration`, to find out which queue we need to read to fill the stageables, the load queue or the store queue. This stageable takes the value of the `LQ_OLDER_THAN_SQ` stageable from the `lqSqArbitration` pipeline.
	- set to true, if the instruction from `lqSqArbitration` is a load
	- set to true, if a store instruction and a load instruction that need to be redone are ready at the same time AND the load instruction is older than the store instruction (we know this by comparing the ROB identifier)
	- set to false, if the instruction from `lqSqArbitration` is a store OR the store is older than a load ready simultaneously
___
- `LQ_ROB_FULL` : load instruction ROB id, used for instructions from`lqSqArbitration` (full = ROB id MSB + ROB id LSBs)
___
- `SQ_ROB_FULL` : store instruction ROB id, used for instructions from`lqSqArbitration` (full = ROB id MSB + ROB id LSBs)
___
- `ROB.ID` : ROB id for instruction processed in the pipeline
	- for instructions from `lqSqArbitration`, we take either the value `LQ_ROB_FULL` or the value `SQ_ROB_FULL` depending on `TAKE_LQ`
	- for instructions from `Agu`, we take the value given by the `Agu` in `robIdFull` field


- `PHYS_RD` : physical register number where to load data
	- for instructions from `lqSqArbitration` , we read the value from the `physRd` field of the associated load queue entry
	- for instructions from `Agu`, we take the value given by the `Agu` in `physicalRd` field
___
- `REGFILE_RD` : destination register type (int, float)
	- for instructions from `lqSqArbitration` , we read the value from the `regfileRd` field of the associated load queue entry
	- for instructions from `Agu`, we take the value given by the `Agu` in `regfileRd` field
___
- `WRITE_RD` : destination register validity, true if we use a destination register
	- for instructions from `lqSqArbitration` , we read the value from the `writeRd` field of the associated load queue entry
	- for instructions from `Agu`, we take the value given by the `Agu` in `writeRd` field
___
- `ADDRESS_PRE_TRANSLATION` : virtual address
	- for instructions from `lqSqArbitration`, we take the value from the `addressPre` field from either the associated load queue entry OR the associated store queue entry, depending on `TAKE_LQ`
	- for instructions from `Agu`, we take the value given by the `Agu` in `address` field
___
- `ADDRESS_POST_TRANSLATION` : physical address
	- for instructions from `lqSqArbitration`, we take the value from the `addressPost` field from either the associated load queue entry OR the associated store queue entry, depending on `TAKE_LQ`. This address may be invalid if the instruction is redone because of MMU refill, as we know from `NEED_TRANSLATION`
	- for instructions from `Agu`, there is no value because address translation has not yet been performed
___
- `SIZE` : load/store size (byte, half, word, double)
	- for instructions from `lqSqArbitration`, we take the value from the `size` field from either the associated load queue entry OR the associated store queue entry, depending on `TAKE_LQ`
	- for instructions from `Agu`, we take the value given by the `Agu` in `size` field
___
- `DATA_MASK` : data mask to determine which part of a 64/32 bit word should be loaded/stored
	- the mask depends on `SIZE`, and also on `ADDRESS_PRE_TRANSLATION` to manage misalignment
___
- `NEED_TRANSLATION` : to know if the instruction needs an address translation
	- for instructions from `lqSqArbitration`, we take the value from the `needTranslation` field from either the associated load queue entry OR the associated store queue entry, depending on `TAKE_LQ`
	- for instructions from `Agu`, is true by default
___
- `TRANSLATED_AS_IO` : to know if it's an IO access
	- for instructions from `lqSqArbitration`, we take the value from the `io` field from either the associated load queue entry OR the associated store queue entry, depending on `TAKE_LQ`
	- for instructions from `Agu`, there is no value because it is the `MmuPlugin` which gives this information based on the address accessed
___
- `UNSIGNED` : to know if it's an unsigned load
	- for instructions from `lqSqArbitration` , we read the value from the `unsigned` field of the associated load queue entry
	- for instructions from `Agu`, we take the value given by the `Agu` in `unsigned` field


- `LR` : to know if it's a load reserved instruction
	- for instructions from `lqSqArbitration` , we read the value from the `lr` field of the associated load queue entry
	- for instructions from `Agu`, we take the value given by the `Agu` in `lr` field
___
- `SC` : to know if it's a store conditional instruction
	- for instructions from `lqSqArbitration` , we read the value from the `sc` field of the associated store queue entry
	- for instructions from `Agu`, we take the value given by the `Agu` in `sc` field
___
- `AMO` : to know if it's an atomic operation instruction
	- for instructions from `lqSqArbitration` , we read the value from the `amo` field of the associated store queue entry
	- for instructions from `Agu`, we take the value given by the `Agu` in `amo` field


- `LQ_ID` : load queue id of the instruction processed
	- for instructions from `lqSqArbitration` , we read the value from the `LQ_ID` stageable of `lqSqArbitration` pipeline
	- for instructions from `Agu`, we take the value given by the `Agu` in `aguId` field
___
- `SQ_ID` : store queue id of the instruction processed
	- for instructions from `lqSqArbitration` , we read the value from the `SQ_ID` stageable of `lqSqArbitration` pipeline
	- for instructions from `Agu`, we take the value given by the `Agu` in `aguId` field


- `SP_FP_ADDRESS` : if the load address comes from the FP or SP register (frame/stack pointer)
	- set to false by default
___
- `LOAD_FRESH` : if the load instruction is processed for the first time by `Lsu2`
	- for instructions from `lqSqArbitration` , set to false
	- for instructions from `Agu`, set to true
___
- `LQ_SQ_ALLOC` : store queue allocation pointer value when we allocate load queue entry
	- for instructions from `lqSqArbitration` , we read the value from the `sqAlloc` field of the associated load queue entry
	- for instructions from `Agu`, we read the value from the `sqAlloc` field of the associated load queue entry. This field was filled in during allocation.
___
- `HIT_SPECULATION` : if the load instruction is likely to hit because the same instruction has been processed several times before
	- for load instructions with a negative hit score so `lq.hitPrediction.likelyToHit = True`, OR if the load address comes from the FP or SP register so `SP_FP_ADDRESS = True`, set to true
	- for load instructions with a positive hit score `lq.hitPrediction.likelyToHit = False`, set to false

- `LQCHECK_START_ID` : first entry in the load queue from which we check at `checkLqHits` stage
	- it's used for store instructions. It gives the load queue entry where the first load instruction, in the program order, after the processed store instruction is located
	- to set the value, we use the `lqAlloc` field of the store queue entry. This field was filled when the store instruction was allocated.
___
- `SQCHECK_END_ID` : last entry in the store queue which we check at `checkSqMask` stage
	- it's used for load instructions. It gives the store queue entry where the last store instruction, in the program order, before the processed load instruction is located
	- to set the value, we use the `sqAlloc` field of the load queue entry. This field was filled when the load instruction was allocated.
___

##### hitSpeculation (for load instructions)
> by default stage 0

In this stage, if `HIT_SPECULATION = True`, we send `wakeRob` and `wakeRf` signals ahead of time, to signal that the load instruction has been executed and the data is in the regfile.

`HIT_SPECULATION = True`, when :
- the same load instruction has been executed in the recent past, there is a high probability that the load will result in a cache hit, because we are loading the same or a close memory address.
- the load address comes from the FP or SP register, so the same or a close memory address because we are loading from the stack. **This case not possible as `SP_FP_ADDRESS` always false by default**
___
##### feedCache
> by default stage 0

This stage sends a load command to the data cache with the virtual address.

##### feedTranslation
> by default stage 1

This stage sends the physical address obtained from the MMU.
It also sends an abord command to the cache, if the MMU gives an exception, such as a privilege exception or a TLB miss, or if it's a peripheral access.

The MMU also tells us whether it is a peripheral access with the `tpk.IO` value

___
##### checkSqMask
> by default stage 1

At this stage, for each load instruction processed, we check whether there is a store instruction in the store queue that points to the same address.
The store instructions checked, are those which both :
- precede the load instruction in the program order (known thanks to `SQCHECK_END_ID`)
- have not yet been committed (known thanks to `sq.ptr.free` pointer)

Pointing to the same address means having at the same time:
- the same address page offset
- the same data mask
They therefore point to the same word in the cache line, but not necessarily to the same word in memory. We don't check the physical address until the next `checkSqArbi` stage.

If we find one or more store instructions that match all of the above, we set the bit associated with the store queue ID to 1, in the `SQCHECK_HITS` stageable.

If there is several store that match, we take the youngest one in the program order. This is the store instruction that will give the most recent value in the program order, and therefore the correct one.
This operation is done thanks to **`roundRobinMaskedInvert`**, and `sq.ptr.priorityLast` that depends on store instructions committed. 
Example :
- SQ 0,1,2 committed => `sq.ptr.priorityLast = 11..111100`
- SQ 3,6 point the same address => `SQCHECK_HITS = 00..01001000`
The store queue ID selected will be the store queue 6 => `OLDER_STORE_ID = 6` and `OLDER_STORE_OH = 00..01000000`

At the same time, other operations are carried out at this stage.
Firstly, we mark for each load instruction that we've checked for the presence of an older store instruction that can result in a RAW hazard, by setting the `sqChecked` field on the load queue entry.

Secondly, we write the `Mmu` response values to the associated fields in the store/load queue entry.
`tpk.IO -> mem.io`
`tpk.REDO -> mem.needTranslation`
`tpk.TRANSLATED -> mem.addressPost`
So, for example, if we have a TLB miss, we will know that the translation hasn't been done yet thanks to the `mem.needTranslation` field.

##### checkSqArbi
> by default stage 2

The operations carried out in this stage are linked to the operations carried out in the previous stage.

As we have seen, when a store instruction gives a RAW risk, we have the ID of the associated store queue, `OLDER_STORE_ID`.

Firstly, we check whether :
- the load and store instructions point to the same physical address
- the load and store instructions have the same size (byte, half, word, double)
- the store is not an atomic instruction (it must not perform a store-to-load forwarding)
It can happen that the store instruction does not yet have its physical address, due to a TLB miss for example. We know this by reading the `needTranslation` field of the store queue entry.

If all 3 points are met, and the store instruction is not waiting for an address translation, we have `OLDER_STORE_BYPASS_SUCCESS = True`. 
This will set the load instruction to `SUCCESS` in the `ctrl` stage, unless the cache gives a cache miss, which will set it to LOAD_MISS even if we have the data needed, because :
- NaxRiscv doesn't check store access being denied by the memory interconnect
- So, if you assume a load is OK because it had a store bypass on cache miss, but the address accessed is effectively not memory mapped (denied by memory interconnect), then you will not produce a trap on the memory load either.

We will also perform the **store-to-load forwarding** in the `cacheRsp` stage by returning the data in the store queue entry to the load.  But the only condition is that `OLDER_STORE_HIT = True`.
This isn't a functional problem, because if `OLDER_STORE_BYPASS_SUCCESS != True`, it won't bring the load instruction into the `SUCCESS` state, and we'll have to process it again.

Secondly, if the store instruction is waiting for an address translation, we check whether the store instruction is being committed or fed into the pipeline, and we set the `OLDER_STORE_COMPLETED` stageable. If the store is currently being processed, or if the store has already been completed, we can process the load instruction again directly afterwards.
___
##### checkLqHits
> by default stage 1

As we are in a out-of-order core, load and store instructions can be reordered.
So, pointing to the same address, a load instruction that comes after a store instruction in the program order can be processed by `Lsu2` before it.
During the `checkSqMask` stage, we will not detect the collision, because we will not have the address of all stores checked for example.

In the event of a collision, the load instruction may load an old value, i.e. an incorrect value, because the store instruction giving the correct value has not yet been processed by `Lsu2`.

That's why, at this stage, for each store instruction processed, we check whether there is a load instruction in the load queue that points to the same address.
The load instructions checked, are those which both :
- are after the store instruction in the program order (known thanks to `LQCHECK_START_ID`)
- are already allocated (known thanks to `lq.ptr.alloc` pointer)

Pointing to the same address means having at the same time:
- the same address page offset
- the same data mask
They therefore point to the same word in the cache line, but not necessarily to the same word in memory. **But compare to above, we don't check the physical address here or in the next `checkLqPrio` stage.**
To give a hit, the load instruction must also have its `sqChecked` field set to true, as this means that it has been processed at least once by `Lsu2`.

If we find one or more load instructions that match all of the above, we set the bit associated with the load queue ID to 1, in the `LQCHECK_HITS` stageable.
We also set the associated `niceHazard` field to true.

##### checkLqPrio
> by default stage 2

If there is several load that match, we take the oldest one in the program order. This is the first load instruction likely to load an incorrect value in the program order, so we will reschedule the execution from this instruction.
This operation is done thanks to **`roundRobinMasked`**, and `lq.ptr.priorityLast` that depends on load instructions committed. 
Example :
- LQ 0,1,2 committed => `lq.ptr.priorityLast = 11..111100`
- LQ 3,6 point the same address => `LQCHECK_HITS = 00..01001000`
The load queue ID selected will be the load queue 3 => `YOUNGER_LOAD_ID = 3` and `YOUNGER_LOAD_OH = 00..00001000`

With the load queue ID known, we read the ROB ID of the load instruction and store it in `YOUNGER_LOAD_ROB`.
This ROB ID will then be sent to the `CommitPlugin` via a reschedule command in `ctrl` stage.
___
##### cacheRsp
> by default stage 2

This stage receives the response from the data cache and processes it.

If we receive data from the cache, by default we receive a 64-bits word. Depending on the address offset, we will shift the data received, and store it in `rspShifted`.

It's also in `rspShifted` that we perform the **store-to-load forwarding** when `OLDER_STORE_HIT = True`. We take the data from the store queue entry, as explain in `checkSqArbi`, instead of data from the cache.

`rspShifted` remains a 64-bit word, depending on the size of the load instruction (byte, half-word, word, double), we select the necessary part from the LSBs (8 bits, 16 bits, 32 bits, 64 bits), as we did the shift.
The MSBs will also be set to zero or one depending on the MSB of the required part and whether it is an unsigned load. The result of these operations is `rspFormated`.

Next, `rspFormated` is written in register file, if : 
- the instruction is a load
- the MMU has not given a privilege error or a miss

Finally, based on all the operations carried out previously in the pipeline, we define the `CTRL` stageable which will be used in the switch case of the next stage :

- `CTRL_ENUM.TRAP_ALIGN` when there is a misalignment problem (the address does not match the load size)
___
- `CTRL_ENUM.MMU_REDO` when there is a miss in the address translation and we have to redo it
___
- `CTRL_ENUM.TRAP_MMU` when the MMU give a privilege error
___
- `CTRL_ENUM.LOAD_HAZARD` when the instruction is a load and we have detected an older store pointing to the same address, but that store is waiting for its address translation.
___
- `CTRL_ENUM.LOAD_MISS` when there is a cache miss for a load instruction
___
- `CTRL_ENUM.LOAD_FAILED` when `specialOverride = True`. This means that we receive a peripheral response or a response for an atomic instruction, and as these responses cannibalise the data path, we have to load again.
___
- `CTRL_ENUM.TRAP_ACCESS` when the cache gives an erroneous response (error sent by the memory to the cache during refill) for a load instruction
___
- `CTRL_ENUM.SUCCESS` otherwise

We define also `TRAP_SPECULATION = True`, when we have `HIT_SPECULATION = True` from `hitSpeculation` stage and it's a peripheral access or `CTRL != CTRL_ENUM.SUCCESS`.
___

> Between the two stages, there is a piece of code which transmits the cache response received at the `cacheRsp` stage via the `LOAD_CACHE_RSP` stageable to the following stages up to `ctrl`. But the `refillSlotAny` and `refillSlot` fields are not transmitted, they are updated at each stage by including the `refillCompletions` cache response. We do this because the cache may finish its refill operation before we reach the `ctrl` stage, and if it does, we will resubmit the load operation directly after the `ctrl` stage.

##### ctrl
> by default stage 3

At this stage, depending on the `CTRL` value, various operations will be performed, such as sending commands to other plugins or writing data to the load/store queue. 

`CTRL_ENUM.TRAP_ALIGN`
- Send a trap command to the `CommitPlugin` with trap cause `LOAD_MISALIGNED`

`CTRL_ENUM.MMU_REDO`
- Indicate in the store or load queue entry that we are waiting for MMU refill by setting the `waitOn.mmuRefillAnySet` field to true.
- If the MMU has already been refilled(`translationWake = True`), indicate that the load operation can be resubmitted directly after the `ctrl` stage.

`CTRL_ENUM.TRAP_MMU`
- Send a trap command to the `CommitPlugin` with trap cause `LOAD_PAGE_FAULT`

`CTRL_ENUM.LOAD_HAZARD`
- Indicate in the load queue entry that we are waiting for an older store pointing to the same address by setting :
	- the `waitOn.sqWritebackSet` field to true.
	- the `waitOn.sqId` field to the ID of the store queue entry.
	- the `waitOn.sqFeedSet` field to true when the store is waiting for its address translation.
- If the store instruction is being committed or fed into the pipeline (`OLDER_STORE_COMPLETED = True`), the load operation can be resubmitted directly after the `ctrl` stage.

`CTRL_ENUM.LOAD_MISS`
- Indicate in the load queue entry that we are waiting for cache refill by setting the `waitOn.cacheRefillSet` field to the number of the cache refill slot being used. If all bits are 1's, this means cache refill slot are full.
- If the cache has already been refilled(`refillMask = False`), indicate that the load operation can be resubmitted directly after the `ctrl` stage.

`CTRL_ENUM.LOAD_FAILED`
- The load operation can be resubmitted directly after the `ctrl` stage.

`CTRL_ENUM.TRAP_ACCESS`
- Send a trap command to the `CommitPlugin` with trap cause `LOAD_ACCESS_FAULT`

`CTRL_ENUM.SUCCESS`
- When it's a load instruction
	- When it is not a peripheral access, we send a `completion` signal to the `RobPlugin` to indicate that the load instruction has been executed.
		- We send the `wakeRob` and `wakeRf` signals to `CommitPlugin`, to indicate that the load instruction has been executed, unless `HIT_SPECULATION = True` because we have sent these signals in `hitSpeculation` stage.
		- When it's a load reserved instruction, we fill in the `lq.reservation` fields.
	- When it's a peripheral access, we set the `lq.mem.doSpecial` field in the load queue entry to true, to indicate that we will have to go through the `special` area in the `Lsu2` plugin.

- When it's a store instruction
	- When `YOUNGER_LOAD_RESCHEDULE = True` as explained in the [[#checkLqHits]] stage, we send a reschedule command to the `CommitPlugin`, to jump to the incorrectly executed load instruction.
	- When it's not a peripheral access, or an atomic operation, or a store conditional, we send a `completion` signal to the `RobPlugin` to indicate that the store instruction has been executed.
	- Otherwise, we set the `sq.mem.doSpecial` field in the store queue entry to true, to indicate that we will have to go through the `special` area in the `Lsu2` plugin.

`TRAP_SPECULATION = True`
- Send a trap command to the `CommitPlugin` with trap cause `LOAD_HIT_MISS_PREDICTED`

Finally, in this `ctrl` stage, we update the hit score as explain in [[#hitPrediction]].

___
#### lqSqArbitration

When a load or store instruction is ready to be redone, it passes through this pipeline before returning to the `sharedPip` pipeline.

This pipeline has two stages `s0` and `s1`. 

In the first, we arbitrate which load instruction will be redone, if several load instructions are ready. 
For arbitration, we use the `roundRobinMasked` function, which returns the oldest load instruction that is ready. When the load instruction is selected, its `regs.redo` field is set to false.
The same applies to store instructions.

In the second stage, we arbitrate between load and store instructions, if there is a load instruction and a store instruction ready to be redone.
To arbitrate, we use the ROB ID of each instruction and select the oldest one.

___
#### Commit

The load and store instructions are committed in the program order.

When a load instruction is committed, we can release its associate entry in the load queue.

When a store instruction is committed, we can write it back in the cache.

___
#### Writeback

##### feed

In this first area, when a store instruction can be written back, we send the `cacheStore` command to the cache with the following fields :
- **valid** : 
	- set to true when the store instruction is committed, and we are not waiting for a cache refill for an older writeback operation.
- **address** : 
	- filled with the physical address in the `sq.mem.addressPost` field of the store queue entry
- **mask** : the data mask to determine which part of the 64 bits word should be written, as we can store a byte, a half, a word or a double.
	- the mask is calculated from the address and size of the storage instruction (byte, half-word, word, double)
- **data** : 
	- depending on the store size, we select the correct part from the LSBs in `sq.mem.data`. As we are sending a 64-bit word, the selected part is repeated to fill the entire word. For example, if the instruction is store byte, we take the 8 LSBs from `sq.mem.data`, and write them 8 times to the `cacheStore.cmd.data` field. Finally, thanks to this repetition and the mask, we'll write the correct byte to the cache.
- **generation** : field that switches from false to true and vice versa after each store command
- **io** : to know whether it's a peripheral store or a memory store
	- filled with the `sq.mem.io` field of the store queue entry
- **prefetch** : to know whether the store command comes from the prefetch predictor or not
	- set to false as here it's a store command due to a store instruction ready to be written back

When the `cacheStore` command is sent, the `ptr.writeBack` pointer is incremented by 1. 
In this way, the next committed store instruction can be written back.

When the `cacheStore` command comes from the prefetch predictor, only the following fields are used : 
- **address** : filled with the physical address in the `prediction.payload` field
- **io** : set to false
- **prefetch** : set to true

##### rsp

In this area, we have a pipelined stream called `delayed`. The size of the pipeline depends on the latency settings of `Lsu2Plugin` and `DataCachePlugin`, by default there are 2 stages.

The cache response stream is connected to the first stage of `delayed`, and after each stage is connected to the next with a delay of 1 cycle. By default, as we have 2 stages, the connections are as follows : cache response => delayed(0) => delayed(1)

Between each stage, the `refillSlotAny` and `refillSlot` fields are not transmitted, they are updated at each stage by including the `refillCompletions` cache response. We do this because the cache may finish its refill operation before we reach the last `delayed` stage.
In the final `delayed` stage, the cache response is processed.

Remember that the data cache is a write-back cache, so to write to the cache you must first fill the cache with the cache line you want to modify.

When we have a cache miss, we fill the `writeback.waitOn` fields to store the refill slot, and we decrement the `ptr.writeBack` pointer to return to the previous pointer value.
When we will receive a `refillCompletions` signal from the cache, we will resend the `cacheStore` command as describe in [[#feed]].
While waiting for the cache refill, no `cacheStore` command can be sent, even if one or more store instructions are ready to be written back.

When we have a cache hit, we free the store queue entry by :
- incrementing the `sq.ptr.free` pointer by 1
- setting the `sq.regs.delete` field of the store queue entry to true
- shifting the `sq.ptr.priority` field left by 1, unless `sq.ptr.priority` was 0, then set everything to 1
- setting the `sq.tracker.add` field to 1, to increase the number of entries available in the store queue `sq.tracker.free`

___
#### flush

When we receive a flush command from `EnvCallPlugin` :
- set `busy` to true
- initialise `cmdPtr` and `rspPtr` to 0
- set `withFree` according to the `flushPort.cmd.withFree` field of the flush command.
When `withFree = True`, as well as invalidating cache lines, we write a random tag to dirty cache lines.

As long as `busy = True`, the fetch pipeline is halted, so that no new instructions enter the core.

If there is no store instruction being written back, we can start flushing the cache (`doit = True`), by executing this loop :
1. Send a store command with `address = cmdPtr` and `flush = True`
2. Receive the cache response 
	1. if `rsp.redo = True`, do not increment `cmdPtr`
	2. else increment `cmdPtr` by 1
3. Return to point 1. until we have covered all the cache lines

Finally, when the cache flush is complete, send a valid response to `EnvCallPlugin`, and set `busy` to false.

___
#### special

This area manages peripheral accesses and atomic instructions.

The load/store instruction arrives here after traversing the `sharedPip` pipeline, where the `doSpecial` field has been set to true in the `SUCCESS` state.

The instruction is processed when it's the next instruction to be committed.
- If it is a peripheral access, we send a peripheral command via `peripheralBus.cmd`.
- If it's an atomic instruction, we start processing it in the `atomic` area.


##### peripheral

To read from or write to a peripheral, we send a peripheral command `peripheralBus.cmd` with the following fields:
- `write` : to know if it's a write or a read command
- `address` : peripheral address
- `size` : access size (byte, half word, word, double)
- `data` : data to be written
- `mask` : mask associated with the data to be written

With `cmdSent` we ensure that the command is only sent once :
- it is set to true, when we send the peripheral command
- it is set to false, when we receive the peripheral response

Then when we receive the response from the peripheral.
From a load command, if :
- the response is valid, the data received is written to the registry file. To write to the registry file, we pass through the `cacheRsp` stage of the `sharedPip` pipeline, in order to use the hardware it contains to shift and format the data. The `specialOverride` variable is set to true to preempt the registry file bus, and avoid collisions with the load currently in `cacheRsp`. We send `wakeRob`, `wakeRf` and `specialCompletion` signals, to signal that the load instruction has been executed and the data is in the regfile.
- the response is wrong, we do the same as above, but we send a trap command to the `CommitPlugin` with trap cause `LOAD_ACCESS_FAULT`

From a store command, if :
- the response is valid, we send a `specialCompletion` signals, to signal that the store instruction has been executed.
- the response is wrong, we do the same as above, but we send a trap command to the `CommitPlugin` with trap cause `STORE_ACCESS_FAULT`

##### atomic

In this area, we have a state machine associated to an ALU.

This state machine only handles atomic operations (ADD, OR, ...) and conditional store instructions, i.e. atomic store instructions.
The load reserved instruction is managed in the `ctrl` state of `sharedPip`.

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 896.944172909026 564.2826402427902" width="896.944172909026" height="564.2826402427902">
  <!-- svg-source:excalidraw -->
  
  <defs>
    <style class="style-fonts">
      @font-face {
        font-family: "Virgil";
        src: url("https://excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://excalidraw.com/Cascadia.woff2");
      }
    </style>
  </defs>
  <rect x="0" y="0" width="896.944172909026" height="564.2826402427902" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(10 244.24527242671218) rotate(0 53.07731917768763 53.07731917768763)"><path d="M106.15 53.08 C106.15 55.39, 106 57.72, 105.7 60.01 C105.4 62.29, 104.94 64.58, 104.35 66.81 C103.75 69.05, 103 71.26, 102.11 73.39 C101.23 75.52, 100.2 77.62, 99.04 79.62 C97.89 81.62, 96.59 83.56, 95.19 85.39 C93.78 87.22, 92.24 88.98, 90.61 90.61 C88.98 92.24, 87.22 93.78, 85.39 95.19 C83.56 96.59, 81.62 97.89, 79.62 99.04 C77.62 100.2, 75.52 101.23, 73.39 102.11 C71.26 103, 69.05 103.75, 66.81 104.35 C64.58 104.94, 62.29 105.4, 60.01 105.7 C57.72 106, 55.39 106.15, 53.08 106.15 C50.77 106.15, 48.44 106, 46.15 105.7 C43.86 105.4, 41.57 104.94, 39.34 104.35 C37.11 103.75, 34.9 103, 32.77 102.11 C30.63 101.23, 28.54 100.2, 26.54 99.04 C24.54 97.89, 22.6 96.59, 20.77 95.19 C18.93 93.78, 17.18 92.24, 15.55 90.61 C13.91 88.98, 12.37 87.22, 10.97 85.39 C9.56 83.56, 8.27 81.62, 7.11 79.62 C5.96 77.62, 4.92 75.52, 4.04 73.39 C3.16 71.26, 2.41 69.05, 1.81 66.81 C1.21 64.58, 0.76 62.29, 0.45 60.01 C0.15 57.72, 0 55.39, 0 53.08 C0 50.77, 0.15 48.44, 0.45 46.15 C0.76 43.86, 1.21 41.57, 1.81 39.34 C2.41 37.11, 3.16 34.9, 4.04 32.77 C4.92 30.63, 5.96 28.54, 7.11 26.54 C8.27 24.54, 9.56 22.6, 10.97 20.77 C12.37 18.93, 13.91 17.18, 15.55 15.55 C17.18 13.91, 18.93 12.37, 20.77 10.97 C22.6 9.56, 24.54 8.27, 26.54 7.11 C28.54 5.96, 30.63 4.92, 32.77 4.04 C34.9 3.16, 37.11 2.41, 39.34 1.81 C41.57 1.21, 43.86 0.76, 46.15 0.45 C48.44 0.15, 50.77 0, 53.08 0 C55.39 0, 57.72 0.15, 60.01 0.45 C62.29 0.76, 64.58 1.21, 66.81 1.81 C69.05 2.41, 71.26 3.16, 73.39 4.04 C75.52 4.92, 77.62 5.96, 79.62 7.11 C81.62 8.27, 83.56 9.56, 85.39 10.97 C87.22 12.37, 88.98 13.91, 90.61 15.55 C92.24 17.18, 93.78 18.93, 95.19 20.77 C96.59 22.6, 97.89 24.54, 99.04 26.54 C100.2 28.54, 101.23 30.63, 102.11 32.77 C103 34.9, 103.75 37.11, 104.35 39.34 C104.94 41.57, 105.4 43.86, 105.7 46.15 C106 48.44, 106.08 51.92, 106.15 53.08 C106.23 54.23, 106.23 51.92, 106.15 53.08" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(22.577319177687627 290.3225916043998) rotate(0 40.5 7)"><text x="40.5" y="11" font-family="Helvetica, Segoe UI Emoji" font-size="12.094923063569215px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">COMPLETION</text></g><g stroke-linecap="round" transform="translate(382.0791528185322 129.2138706212101) rotate(0 53.07731917768763 53.07731917768763)"><path d="M106.15 53.08 C106.15 55.39, 106 57.72, 105.7 60.01 C105.4 62.29, 104.94 64.58, 104.35 66.81 C103.75 69.05, 103 71.26, 102.11 73.39 C101.23 75.52, 100.2 77.62, 99.04 79.62 C97.89 81.62, 96.59 83.56, 95.19 85.39 C93.78 87.22, 92.24 88.98, 90.61 90.61 C88.98 92.24, 87.22 93.78, 85.39 95.19 C83.56 96.59, 81.62 97.89, 79.62 99.04 C77.62 100.2, 75.52 101.23, 73.39 102.11 C71.26 103, 69.05 103.75, 66.81 104.35 C64.58 104.94, 62.29 105.4, 60.01 105.7 C57.72 106, 55.39 106.15, 53.08 106.15 C50.77 106.15, 48.44 106, 46.15 105.7 C43.86 105.4, 41.57 104.94, 39.34 104.35 C37.11 103.75, 34.9 103, 32.77 102.11 C30.63 101.23, 28.54 100.2, 26.54 99.04 C24.54 97.89, 22.6 96.59, 20.77 95.19 C18.93 93.78, 17.18 92.24, 15.55 90.61 C13.91 88.98, 12.37 87.22, 10.97 85.39 C9.56 83.56, 8.27 81.62, 7.11 79.62 C5.96 77.62, 4.92 75.52, 4.04 73.39 C3.16 71.26, 2.41 69.05, 1.81 66.81 C1.21 64.58, 0.76 62.29, 0.45 60.01 C0.15 57.72, 0 55.39, 0 53.08 C0 50.77, 0.15 48.44, 0.45 46.15 C0.76 43.86, 1.21 41.57, 1.81 39.34 C2.41 37.11, 3.16 34.9, 4.04 32.77 C4.92 30.63, 5.96 28.54, 7.11 26.54 C8.27 24.54, 9.56 22.6, 10.97 20.77 C12.37 18.93, 13.91 17.18, 15.55 15.55 C17.18 13.91, 18.93 12.37, 20.77 10.97 C22.6 9.56, 24.54 8.27, 26.54 7.11 C28.54 5.96, 30.63 4.92, 32.77 4.04 C34.9 3.16, 37.11 2.41, 39.34 1.81 C41.57 1.21, 43.86 0.76, 46.15 0.45 C48.44 0.15, 50.77 0, 53.08 0 C55.39 0, 57.72 0.15, 60.01 0.45 C62.29 0.76, 64.58 1.21, 66.81 1.81 C69.05 2.41, 71.26 3.16, 73.39 4.04 C75.52 4.92, 77.62 5.96, 79.62 7.11 C81.62 8.27, 83.56 9.56, 85.39 10.97 C87.22 12.37, 88.98 13.91, 90.61 15.55 C92.24 17.18, 93.78 18.93, 95.19 20.77 C96.59 22.6, 97.89 24.54, 99.04 26.54 C100.2 28.54, 101.23 30.63, 102.11 32.77 C103 34.9, 103.75 37.11, 104.35 39.34 C104.94 41.57, 105.4 43.86, 105.7 46.15 C106 48.44, 106.08 51.92, 106.15 53.08 C106.23 54.23, 106.23 51.92, 106.15 53.08" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(421.1564719962199 175.29118979889773) rotate(0 14 7)"><text x="14" y="11" font-family="Helvetica, Segoe UI Emoji" font-size="12.094923063569215px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">IDLE</text></g><g stroke-linecap="round" transform="translate(490.53364883493975 366.78086189524595) rotate(0 53.07731917768763 53.077319177687635)"><path d="M106.15 53.08 C106.15 55.39, 106 57.72, 105.7 60.01 C105.4 62.29, 104.94 64.58, 104.35 66.81 C103.75 69.05, 103 71.26, 102.11 73.39 C101.23 75.52, 100.2 77.62, 99.04 79.62 C97.89 81.62, 96.59 83.56, 95.19 85.39 C93.78 87.22, 92.24 88.98, 90.61 90.61 C88.98 92.24, 87.22 93.78, 85.39 95.19 C83.56 96.59, 81.62 97.89, 79.62 99.04 C77.62 100.2, 75.52 101.23, 73.39 102.11 C71.26 103, 69.05 103.75, 66.81 104.35 C64.58 104.94, 62.29 105.4, 60.01 105.7 C57.72 106, 55.39 106.15, 53.08 106.15 C50.77 106.15, 48.44 106, 46.15 105.7 C43.86 105.4, 41.57 104.94, 39.34 104.35 C37.11 103.75, 34.9 103, 32.77 102.11 C30.63 101.23, 28.54 100.2, 26.54 99.04 C24.54 97.89, 22.6 96.59, 20.77 95.19 C18.93 93.78, 17.18 92.24, 15.55 90.61 C13.91 88.98, 12.37 87.22, 10.97 85.39 C9.56 83.56, 8.27 81.62, 7.11 79.62 C5.96 77.62, 4.92 75.52, 4.04 73.39 C3.16 71.26, 2.41 69.05, 1.81 66.81 C1.21 64.58, 0.76 62.29, 0.45 60.01 C0.15 57.72, 0 55.39, 0 53.08 C0 50.77, 0.15 48.44, 0.45 46.15 C0.76 43.86, 1.21 41.57, 1.81 39.34 C2.41 37.11, 3.16 34.9, 4.04 32.77 C4.92 30.63, 5.96 28.54, 7.11 26.54 C8.27 24.54, 9.56 22.6, 10.97 20.77 C12.37 18.93, 13.91 17.18, 15.55 15.55 C17.18 13.91, 18.93 12.37, 20.77 10.97 C22.6 9.56, 24.54 8.27, 26.54 7.11 C28.54 5.96, 30.63 4.92, 32.77 4.04 C34.9 3.16, 37.11 2.41, 39.34 1.81 C41.57 1.21, 43.86 0.76, 46.15 0.45 C48.44 0.15, 50.77 0, 53.08 0 C55.39 0, 57.72 0.15, 60.01 0.45 C62.29 0.76, 64.58 1.21, 66.81 1.81 C69.05 2.41, 71.26 3.16, 73.39 4.04 C75.52 4.92, 77.62 5.96, 79.62 7.11 C81.62 8.27, 83.56 9.56, 85.39 10.97 C87.22 12.37, 88.98 13.91, 90.61 15.55 C92.24 17.18, 93.78 18.93, 95.19 20.77 C96.59 22.6, 97.89 24.54, 99.04 26.54 C100.2 28.54, 101.23 30.63, 102.11 32.77 C103 34.9, 103.75 37.11, 104.35 39.34 C104.94 41.57, 105.4 43.86, 105.7 46.15 C106 48.44, 106.08 51.92, 106.15 53.08 C106.23 54.23, 106.23 51.92, 106.15 53.08" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(509.6109680126275 412.8581810729336) rotate(0 34 7)"><text x="34" y="11" font-family="Helvetica, Segoe UI Emoji" font-size="12.094923063569215px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">LOAD_CMD</text></g><g stroke-linecap="round" transform="translate(751.3408892553492 244.24527242671218) rotate(0 53.07731917768763 53.07731917768763)"><path d="M106.15 53.08 C106.15 55.39, 106 57.72, 105.7 60.01 C105.4 62.29, 104.94 64.58, 104.35 66.81 C103.75 69.05, 103 71.26, 102.11 73.39 C101.23 75.52, 100.2 77.62, 99.04 79.62 C97.89 81.62, 96.59 83.56, 95.19 85.39 C93.78 87.22, 92.24 88.98, 90.61 90.61 C88.98 92.24, 87.22 93.78, 85.39 95.19 C83.56 96.59, 81.62 97.89, 79.62 99.04 C77.62 100.2, 75.52 101.23, 73.39 102.11 C71.26 103, 69.05 103.75, 66.81 104.35 C64.58 104.94, 62.29 105.4, 60.01 105.7 C57.72 106, 55.39 106.15, 53.08 106.15 C50.77 106.15, 48.44 106, 46.15 105.7 C43.86 105.4, 41.57 104.94, 39.34 104.35 C37.11 103.75, 34.9 103, 32.77 102.11 C30.63 101.23, 28.54 100.2, 26.54 99.04 C24.54 97.89, 22.6 96.59, 20.77 95.19 C18.93 93.78, 17.18 92.24, 15.55 90.61 C13.91 88.98, 12.37 87.22, 10.97 85.39 C9.56 83.56, 8.27 81.62, 7.11 79.62 C5.96 77.62, 4.92 75.52, 4.04 73.39 C3.16 71.26, 2.41 69.05, 1.81 66.81 C1.21 64.58, 0.76 62.29, 0.45 60.01 C0.15 57.72, 0 55.39, 0 53.08 C0 50.77, 0.15 48.44, 0.45 46.15 C0.76 43.86, 1.21 41.57, 1.81 39.34 C2.41 37.11, 3.16 34.9, 4.04 32.77 C4.92 30.63, 5.96 28.54, 7.11 26.54 C8.27 24.54, 9.56 22.6, 10.97 20.77 C12.37 18.93, 13.91 17.18, 15.55 15.55 C17.18 13.91, 18.93 12.37, 20.77 10.97 C22.6 9.56, 24.54 8.27, 26.54 7.11 C28.54 5.96, 30.63 4.92, 32.77 4.04 C34.9 3.16, 37.11 2.41, 39.34 1.81 C41.57 1.21, 43.86 0.76, 46.15 0.45 C48.44 0.15, 50.77 0, 53.08 0 C55.39 0, 57.72 0.15, 60.01 0.45 C62.29 0.76, 64.58 1.21, 66.81 1.81 C69.05 2.41, 71.26 3.16, 73.39 4.04 C75.52 4.92, 77.62 5.96, 79.62 7.11 C81.62 8.27, 83.56 9.56, 85.39 10.97 C87.22 12.37, 88.98 13.91, 90.61 15.55 C92.24 17.18, 93.78 18.93, 95.19 20.77 C96.59 22.6, 97.89 24.54, 99.04 26.54 C100.2 28.54, 101.23 30.63, 102.11 32.77 C103 34.9, 103.75 37.11, 104.35 39.34 C104.94 41.57, 105.4 43.86, 105.7 46.15 C106 48.44, 106.08 51.92, 106.15 53.08 C106.23 54.23, 106.23 51.92, 106.15 53.08" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(771.918208433037 290.3225916043998) rotate(0 32.5 7)"><text x="32.5" y="11" font-family="Helvetica, Segoe UI Emoji" font-size="12.094923063569215px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">LOAD_RSP</text></g><g stroke-linecap="round" transform="translate(642.8863932389412 10) rotate(0 53.07731917768763 53.07731917768763)"><path d="M106.15 53.08 C106.15 55.39, 106 57.72, 105.7 60.01 C105.4 62.29, 104.94 64.58, 104.35 66.81 C103.75 69.05, 103 71.26, 102.11 73.39 C101.23 75.52, 100.2 77.62, 99.04 79.62 C97.89 81.62, 96.59 83.56, 95.19 85.39 C93.78 87.22, 92.24 88.98, 90.61 90.61 C88.98 92.24, 87.22 93.78, 85.39 95.19 C83.56 96.59, 81.62 97.89, 79.62 99.04 C77.62 100.2, 75.52 101.23, 73.39 102.11 C71.26 103, 69.05 103.75, 66.81 104.35 C64.58 104.94, 62.29 105.4, 60.01 105.7 C57.72 106, 55.39 106.15, 53.08 106.15 C50.77 106.15, 48.44 106, 46.15 105.7 C43.86 105.4, 41.57 104.94, 39.34 104.35 C37.11 103.75, 34.9 103, 32.77 102.11 C30.63 101.23, 28.54 100.2, 26.54 99.04 C24.54 97.89, 22.6 96.59, 20.77 95.19 C18.93 93.78, 17.18 92.24, 15.55 90.61 C13.91 88.98, 12.37 87.22, 10.97 85.39 C9.56 83.56, 8.27 81.62, 7.11 79.62 C5.96 77.62, 4.92 75.52, 4.04 73.39 C3.16 71.26, 2.41 69.05, 1.81 66.81 C1.21 64.58, 0.76 62.29, 0.45 60.01 C0.15 57.72, 0 55.39, 0 53.08 C0 50.77, 0.15 48.44, 0.45 46.15 C0.76 43.86, 1.21 41.57, 1.81 39.34 C2.41 37.11, 3.16 34.9, 4.04 32.77 C4.92 30.63, 5.96 28.54, 7.11 26.54 C8.27 24.54, 9.56 22.6, 10.97 20.77 C12.37 18.93, 13.91 17.18, 15.55 15.55 C17.18 13.91, 18.93 12.37, 20.77 10.97 C22.6 9.56, 24.54 8.27, 26.54 7.11 C28.54 5.96, 30.63 4.92, 32.77 4.04 C34.9 3.16, 37.11 2.41, 39.34 1.81 C41.57 1.21, 43.86 0.76, 46.15 0.45 C48.44 0.15, 50.77 0, 53.08 0 C55.39 0, 57.72 0.15, 60.01 0.45 C62.29 0.76, 64.58 1.21, 66.81 1.81 C69.05 2.41, 71.26 3.16, 73.39 4.04 C75.52 4.92, 77.62 5.96, 79.62 7.11 C81.62 8.27, 83.56 9.56, 85.39 10.97 C87.22 12.37, 88.98 13.91, 90.61 15.55 C92.24 17.18, 93.78 18.93, 95.19 20.77 C96.59 22.6, 97.89 24.54, 99.04 26.54 C100.2 28.54, 101.23 30.63, 102.11 32.77 C103 34.9, 103.75 37.11, 104.35 39.34 C104.94 41.57, 105.4 43.86, 105.7 46.15 C106 48.44, 106.08 51.92, 106.15 53.08 C106.23 54.23, 106.23 51.92, 106.15 53.08" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(679.4637124166289 56.07731917768763) rotate(0 16.5 7)"><text x="16.5" y="11" font-family="Helvetica, Segoe UI Emoji" font-size="12.094923063569215px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">TRAP</text></g><g stroke-linecap="round" transform="translate(273.6246568021244 366.78086189524595) rotate(0 53.07731917768763 53.077319177687635)"><path d="M106.15 53.08 C106.15 55.39, 106 57.72, 105.7 60.01 C105.4 62.29, 104.94 64.58, 104.35 66.81 C103.75 69.05, 103 71.26, 102.11 73.39 C101.23 75.52, 100.2 77.62, 99.04 79.62 C97.89 81.62, 96.59 83.56, 95.19 85.39 C93.78 87.22, 92.24 88.98, 90.61 90.61 C88.98 92.24, 87.22 93.78, 85.39 95.19 C83.56 96.59, 81.62 97.89, 79.62 99.04 C77.62 100.2, 75.52 101.23, 73.39 102.11 C71.26 103, 69.05 103.75, 66.81 104.35 C64.58 104.94, 62.29 105.4, 60.01 105.7 C57.72 106, 55.39 106.15, 53.08 106.15 C50.77 106.15, 48.44 106, 46.15 105.7 C43.86 105.4, 41.57 104.94, 39.34 104.35 C37.11 103.75, 34.9 103, 32.77 102.11 C30.63 101.23, 28.54 100.2, 26.54 99.04 C24.54 97.89, 22.6 96.59, 20.77 95.19 C18.93 93.78, 17.18 92.24, 15.55 90.61 C13.91 88.98, 12.37 87.22, 10.97 85.39 C9.56 83.56, 8.27 81.62, 7.11 79.62 C5.96 77.62, 4.92 75.52, 4.04 73.39 C3.16 71.26, 2.41 69.05, 1.81 66.81 C1.21 64.58, 0.76 62.29, 0.45 60.01 C0.15 57.72, 0 55.39, 0 53.08 C0 50.77, 0.15 48.44, 0.45 46.15 C0.76 43.86, 1.21 41.57, 1.81 39.34 C2.41 37.11, 3.16 34.9, 4.04 32.77 C4.92 30.63, 5.96 28.54, 7.11 26.54 C8.27 24.54, 9.56 22.6, 10.97 20.77 C12.37 18.93, 13.91 17.18, 15.55 15.55 C17.18 13.91, 18.93 12.37, 20.77 10.97 C22.6 9.56, 24.54 8.27, 26.54 7.11 C28.54 5.96, 30.63 4.92, 32.77 4.04 C34.9 3.16, 37.11 2.41, 39.34 1.81 C41.57 1.21, 43.86 0.76, 46.15 0.45 C48.44 0.15, 50.77 0, 53.08 0 C55.39 0, 57.72 0.15, 60.01 0.45 C62.29 0.76, 64.58 1.21, 66.81 1.81 C69.05 2.41, 71.26 3.16, 73.39 4.04 C75.52 4.92, 77.62 5.96, 79.62 7.11 C81.62 8.27, 83.56 9.56, 85.39 10.97 C87.22 12.37, 88.98 13.91, 90.61 15.55 C92.24 17.18, 93.78 18.93, 95.19 20.77 C96.59 22.6, 97.89 24.54, 99.04 26.54 C100.2 28.54, 101.23 30.63, 102.11 32.77 C103 34.9, 103.75 37.11, 104.35 39.34 C104.94 41.57, 105.4 43.86, 105.7 46.15 C106 48.44, 106.08 51.92, 106.15 53.08 C106.23 54.23, 106.23 51.92, 106.15 53.08" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(314.7019759798121 412.8581810729336) rotate(0 12 7)"><text x="12" y="11" font-family="Helvetica, Segoe UI Emoji" font-size="12.094923063569215px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">ALU</text></g><g stroke-linecap="round" transform="translate(118.68966249297091 10) rotate(0 53.07731917768763 53.07731917768763)"><path d="M106.15 53.08 C106.15 55.39, 106 57.72, 105.7 60.01 C105.4 62.29, 104.94 64.58, 104.35 66.81 C103.75 69.05, 103 71.26, 102.11 73.39 C101.23 75.52, 100.2 77.62, 99.04 79.62 C97.89 81.62, 96.59 83.56, 95.19 85.39 C93.78 87.22, 92.24 88.98, 90.61 90.61 C88.98 92.24, 87.22 93.78, 85.39 95.19 C83.56 96.59, 81.62 97.89, 79.62 99.04 C77.62 100.2, 75.52 101.23, 73.39 102.11 C71.26 103, 69.05 103.75, 66.81 104.35 C64.58 104.94, 62.29 105.4, 60.01 105.7 C57.72 106, 55.39 106.15, 53.08 106.15 C50.77 106.15, 48.44 106, 46.15 105.7 C43.86 105.4, 41.57 104.94, 39.34 104.35 C37.11 103.75, 34.9 103, 32.77 102.11 C30.63 101.23, 28.54 100.2, 26.54 99.04 C24.54 97.89, 22.6 96.59, 20.77 95.19 C18.93 93.78, 17.18 92.24, 15.55 90.61 C13.91 88.98, 12.37 87.22, 10.97 85.39 C9.56 83.56, 8.27 81.62, 7.11 79.62 C5.96 77.62, 4.92 75.52, 4.04 73.39 C3.16 71.26, 2.41 69.05, 1.81 66.81 C1.21 64.58, 0.76 62.29, 0.45 60.01 C0.15 57.72, 0 55.39, 0 53.08 C0 50.77, 0.15 48.44, 0.45 46.15 C0.76 43.86, 1.21 41.57, 1.81 39.34 C2.41 37.11, 3.16 34.9, 4.04 32.77 C4.92 30.63, 5.96 28.54, 7.11 26.54 C8.27 24.54, 9.56 22.6, 10.97 20.77 C12.37 18.93, 13.91 17.18, 15.55 15.55 C17.18 13.91, 18.93 12.37, 20.77 10.97 C22.6 9.56, 24.54 8.27, 26.54 7.11 C28.54 5.96, 30.63 4.92, 32.77 4.04 C34.9 3.16, 37.11 2.41, 39.34 1.81 C41.57 1.21, 43.86 0.76, 46.15 0.45 C48.44 0.15, 50.77 0, 53.08 0 C55.39 0, 57.72 0.15, 60.01 0.45 C62.29 0.76, 64.58 1.21, 66.81 1.81 C69.05 2.41, 71.26 3.16, 73.39 4.04 C75.52 4.92, 77.62 5.96, 79.62 7.11 C81.62 8.27, 83.56 9.56, 85.39 10.97 C87.22 12.37, 88.98 13.91, 90.61 15.55 C92.24 17.18, 93.78 18.93, 95.19 20.77 C96.59 22.6, 97.89 24.54, 99.04 26.54 C100.2 28.54, 101.23 30.63, 102.11 32.77 C103 34.9, 103.75 37.11, 104.35 39.34 C104.94 41.57, 105.4 43.86, 105.7 46.15 C106 48.44, 106.08 51.92, 106.15 53.08 C106.23 54.23, 106.23 51.92, 106.15 53.08" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(154.26698167065854 56.07731917768763) rotate(0 17.5 7)"><text x="17.5" y="11" font-family="Helvetica, Segoe UI Emoji" font-size="12.094923063569215px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">SYNC</text></g><g stroke-linecap="round"><g transform="translate(467.8649707948192 226.18943818649137) rotate(0 37.442623624712155 69.29037245492712)"><path d="M0 0 C29.74 55.03, 59.48 110.06, 74.89 138.58 M0 0 C26.56 49.14, 53.11 98.29, 74.89 138.58" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(467.8649707948192 226.18943818649137) rotate(0 37.442623624712155 69.29037245492712)"><path d="M74.89 138.58 L62.85 129.63 L74 123.61 L74.89 138.58" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M74.89 138.58 C70.1 135.03, 65.32 131.48, 62.85 129.63 M74.89 138.58 C70.62 135.41, 66.35 132.24, 62.85 129.63 M62.85 129.63 C66.2 127.82, 69.56 126.01, 74 123.61 M62.85 129.63 C66 127.93, 69.14 126.23, 74 123.61 M74 123.61 C74.25 127.88, 74.51 132.16, 74.89 138.58 M74 123.61 C74.32 128.95, 74.63 134.3, 74.89 138.58 M74.89 138.58 C74.89 138.58, 74.89 138.58, 74.89 138.58 M74.89 138.58 C74.89 138.58, 74.89 138.58, 74.89 138.58" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(404.59984811858146 226.18943818649143) rotate(0 -37.872998608904254 70.1511224233113)"><path d="M0 0 C-18.7 34.64, -37.41 69.29, -75.75 140.3 M0 0 C-20.92 38.75, -41.84 77.5, -75.75 140.3" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(404.59984811858146 226.18943818649143) rotate(0 -37.872998608904254 70.1511224233113)"><path d="M-75.75 140.3 L-74.87 125.33 L-63.71 131.35 L-75.75 140.3" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M-75.75 140.3 C-75.53 136.6, -75.31 132.91, -74.87 125.33 M-75.75 140.3 C-75.5 136.17, -75.26 132.03, -74.87 125.33 M-74.87 125.33 C-72.29 126.72, -69.7 128.11, -63.71 131.35 M-74.87 125.33 C-70.97 127.43, -67.07 129.54, -63.71 131.35 M-63.71 131.35 C-66.57 133.48, -69.43 135.6, -75.75 140.3 M-63.71 131.35 C-66.64 133.53, -69.58 135.72, -75.75 140.3 M-75.75 140.3 C-75.75 140.3, -75.75 140.3, -75.75 140.3 M-75.75 140.3 C-75.75 140.3, -75.75 140.3, -75.75 140.3" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(596.9774660524475 410.38993142070757) rotate(0 80.4801220439216 -42.607123435017286)"><path d="M0 0 C26.83 -14.2, 134.13 -71.01, 160.96 -85.21 M0 0 C26.83 -14.2, 134.13 -71.01, 160.96 -85.21" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(596.9774660524475 410.38993142070757) rotate(0 80.4801220439216 -42.607123435017286)"><path d="M160.96 -85.21 L151.91 -73.25 L145.98 -84.46 L160.96 -85.21" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M160.96 -85.21 C158.15 -81.5, 155.34 -77.78, 151.91 -73.25 M160.96 -85.21 C158.13 -81.48, 155.31 -77.74, 151.91 -73.25 M151.91 -73.25 C150.44 -76.03, 148.97 -78.81, 145.98 -84.46 M151.91 -73.25 C149.67 -77.49, 147.43 -81.73, 145.98 -84.46 M145.98 -84.46 C151.02 -84.71, 156.06 -84.97, 160.96 -85.21 M145.98 -84.46 C149.73 -84.65, 153.49 -84.84, 160.96 -85.21 M160.96 -85.21 C160.96 -85.21, 160.96 -85.21, 160.96 -85.21 M160.96 -85.21 C160.96 -85.21, 160.96 -85.21, 160.96 -85.21" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(587.0788414160294 386.28893230595037) rotate(0 81.7712469964979 -43.037498419209385)"><path d="M0 0 C27.26 -14.35, 136.29 -71.73, 163.54 -86.07 M0 0 C27.26 -14.35, 136.29 -71.73, 163.54 -86.07" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(587.0788414160294 386.28893230595037) rotate(0 81.7712469964979 -43.037498419209385)"><path d="M0 0 L9.08 -11.94 L14.98 -0.72 L0 0" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M0 0 C3.39 -4.46, 6.79 -8.93, 9.08 -11.94 M0 0 C2.93 -3.85, 5.86 -7.71, 9.08 -11.94 M9.08 -11.94 C10.63 -8.98, 12.19 -6.02, 14.98 -0.72 M9.08 -11.94 C10.9 -8.49, 12.71 -5.03, 14.98 -0.72 M14.98 -0.72 C11.98 -0.58, 8.98 -0.43, 0 0 M14.98 -0.72 C11.71 -0.56, 8.45 -0.41, 0 0 M0 0 C0 0, 0 0, 0 0 M0 0 C0 0, 0 0, 0 0" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(805.2789584014209 243.40443755417505) rotate(0 -30.337224178099746 -77.897872138769)"><path d="M0 0 C-0.29 -8.32, 2.01 -31.42, -1.72 -49.92 C-5.45 -68.43, -12.48 -93.39, -22.38 -111.04 C-32.28 -128.68, -54.66 -148.34, -61.11 -155.8 M0 0 C-0.29 -8.32, 2.01 -31.42, -1.72 -49.92 C-5.45 -68.43, -12.48 -93.39, -22.38 -111.04 C-32.28 -128.68, -54.66 -148.34, -61.11 -155.8" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(805.2789584014209 243.40443755417505) rotate(0 -30.337224178099746 -77.897872138769)"><path d="M-61.11 -155.8 L-47.1 -150.46 L-56.19 -141.63 L-61.11 -155.8" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M-61.11 -155.8 C-58.12 -154.66, -55.13 -153.52, -47.1 -150.46 M-61.11 -155.8 C-57.57 -154.45, -54.02 -153.09, -47.1 -150.46 M-47.1 -150.46 C-50.4 -147.25, -53.71 -144.04, -56.19 -141.63 M-47.1 -150.46 C-50.33 -147.32, -53.56 -144.18, -56.19 -141.63 M-56.19 -141.63 C-58.14 -147.22, -60.08 -152.82, -61.11 -155.8 M-56.19 -141.63 C-57.86 -146.44, -59.53 -151.25, -61.11 -155.8 M-61.11 -155.8 C-61.11 -155.8, -61.11 -155.8, -61.11 -155.8 M-61.11 -155.8 C-61.11 -155.8, -61.11 -155.8, -61.11 -155.8" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(641.7364644084254 66.95069403541657) rotate(0 -83.9059437251641 38.32055178539045)"><path d="M0 0 C-10.07 1.52, -40.67 3.66, -60.41 9.12 C-80.15 14.57, -100.53 21.49, -118.43 32.74 C-136.33 44, -159.58 69.32, -167.81 76.64 M0 0 C-10.07 1.52, -40.67 3.66, -60.41 9.12 C-80.15 14.57, -100.53 21.49, -118.43 32.74 C-136.33 44, -159.58 69.32, -167.81 76.64" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(641.7364644084254 66.95069403541657) rotate(0 -83.9059437251641 38.32055178539045)"><path d="M-167.81 76.64 L-162.47 62.63 L-153.64 71.73 L-167.81 76.64" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M-167.81 76.64 C-166.2 72.41, -164.58 68.17, -162.47 62.63 M-167.81 76.64 C-166.36 72.84, -164.91 69.04, -162.47 62.63 M-162.47 62.63 C-160.35 64.81, -158.24 66.99, -153.64 71.73 M-162.47 62.63 C-160.16 65, -157.86 67.38, -153.64 71.73 M-153.64 71.73 C-159.27 73.68, -164.91 75.63, -167.81 76.64 M-153.64 71.73 C-156.96 72.88, -160.27 74.03, -167.81 76.64 M-167.81 76.64 C-167.81 76.64, -167.81 76.64, -167.81 76.64 M-167.81 76.64 C-167.81 76.64, -167.81 76.64, -167.81 76.64" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(275.7577738227427 402.1387869755921) rotate(0 -81.53455601357564 -41.79502451116059)"><path d="M0 0 C-41.24 -21.14, -82.48 -42.28, -163.07 -83.59 M0 0 C-51.58 -26.44, -103.16 -52.88, -163.07 -83.59" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(275.7577738227427 402.1387869755921) rotate(0 -81.53455601357564 -41.79502451116059)"><path d="M-163.07 -83.59 L-148.08 -83.03 L-153.86 -71.75 L-163.07 -83.59" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M-163.07 -83.59 C-159.28 -83.45, -155.49 -83.31, -148.08 -83.03 M-163.07 -83.59 C-158.33 -83.41, -153.59 -83.24, -148.08 -83.03 M-148.08 -83.03 C-149.68 -79.92, -151.27 -76.8, -153.86 -71.75 M-148.08 -83.03 C-150.28 -78.74, -152.48 -74.44, -153.86 -71.75 M-153.86 -71.75 C-157.46 -76.37, -161.05 -80.99, -163.07 -83.59 M-153.86 -71.75 C-156.67 -75.36, -159.48 -78.98, -163.07 -83.59 M-163.07 -83.59 C-163.07 -83.59, -163.07 -83.59, -163.07 -83.59 M-163.07 -83.59 C-163.07 -83.59, -163.07 -83.59, -163.07 -83.59" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(61.98650091319996 243.18066096593213) rotate(0 30.420222928818305 -78.10873433233289)"><path d="M0 0 C0.23 -11.19, -2.74 -46.59, 1.37 -67.15 C5.48 -87.7, 14.62 -108.48, 24.67 -123.33 C34.71 -138.17, 55.5 -150.74, 61.66 -156.22 M0 0 C0.23 -11.19, -2.74 -46.59, 1.37 -67.15 C5.48 -87.7, 14.62 -108.48, 24.67 -123.33 C34.71 -138.17, 55.5 -150.74, 61.66 -156.22" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(61.98650091319996 243.18066096593213) rotate(0 30.420222928818305 -78.10873433233289)"><path d="M61.66 -156.22 L54.69 -142.94 L47.01 -153.02 L61.66 -156.22" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M61.66 -156.22 C59.2 -151.52, 56.74 -146.83, 54.69 -142.94 M61.66 -156.22 C59.01 -151.16, 56.35 -146.1, 54.69 -142.94 M54.69 -142.94 C52.59 -145.7, 50.48 -148.47, 47.01 -153.02 M54.69 -142.94 C52.08 -146.36, 49.47 -149.79, 47.01 -153.02 M47.01 -153.02 C51.64 -154.03, 56.28 -155.04, 61.66 -156.22 M47.01 -153.02 C51.92 -154.09, 56.83 -155.16, 61.66 -156.22 M61.66 -156.22 C61.66 -156.22, 61.66 -156.22, 61.66 -156.22 M61.66 -156.22 C61.66 -156.22, 61.66 -156.22, 61.66 -156.22" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(226.4259416128482 60.92694752382209) rotate(0 84.9603776948183 41.79502451116059)"><path d="M0 0 C10.28 1.14, 41.11 1.14, 61.66 6.85 C82.22 12.56, 105.29 21.47, 123.33 34.26 C141.37 47.05, 162.16 75.37, 169.92 83.59 M0 0 C10.28 1.14, 41.11 1.14, 61.66 6.85 C82.22 12.56, 105.29 21.47, 123.33 34.26 C141.37 47.05, 162.16 75.37, 169.92 83.59" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(226.4259416128482 60.92694752382209) rotate(0 84.9603776948183 41.79502451116059)"><path d="M169.92 83.59 L156.29 77.33 L165.95 69.12 L169.92 83.59" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M169.92 83.59 C166.69 82.11, 163.47 80.63, 156.29 77.33 M169.92 83.59 C164.62 81.16, 159.32 78.72, 156.29 77.33 M156.29 77.33 C158.43 75.51, 160.58 73.69, 165.95 69.12 M156.29 77.33 C159.55 74.56, 162.81 71.8, 165.95 69.12 M165.95 69.12 C166.78 72.16, 167.62 75.19, 169.92 83.59 M165.95 69.12 C167.11 73.36, 168.27 77.59, 169.92 83.59 M169.92 83.59 C169.92 83.59, 169.92 83.59, 169.92 83.59 M169.92 83.59 C169.92 83.59, 169.92 83.59, 169.92 83.59" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(804.7046414066114 351.43662609320063) rotate(0 -218.56742326328242 86.63259861342488)"><path d="M0 0 C-5.94 15.76, -8.22 66.92, -35.63 94.55 C-63.04 122.19, -113.74 154.16, -164.44 165.81 C-215.14 177.46, -294.39 174.26, -339.84 164.44 C-385.29 154.62, -420.92 116.48, -437.13 106.89 M0 0 C-5.94 15.76, -8.22 66.92, -35.63 94.55 C-63.04 122.19, -113.74 154.16, -164.44 165.81 C-215.14 177.46, -294.39 174.26, -339.84 164.44 C-385.29 154.62, -420.92 116.48, -437.13 106.89" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(804.7046414066114 351.43662609320063) rotate(0 -218.56742326328242 86.63259861342488)"><path d="M-437.13 106.89 L-422.47 110.03 L-430.12 120.14 L-437.13 106.89" stroke="none" stroke-width="0" fill="#000000" fill-rule="evenodd"></path><path d="M-437.13 106.89 C-431.62 108.07, -426.11 109.25, -422.47 110.03 M-437.13 106.89 C-432.2 107.94, -427.26 109, -422.47 110.03 M-422.47 110.03 C-425.17 113.6, -427.87 117.18, -430.12 120.14 M-422.47 110.03 C-424.24 112.37, -426.01 114.72, -430.12 120.14 M-430.12 120.14 C-431.76 117.04, -433.4 113.95, -437.13 106.89 M-430.12 120.14 C-431.57 117.4, -433.01 114.67, -437.13 106.89 M-437.13 106.89 C-437.13 106.89, -437.13 106.89, -437.13 106.89 M-437.13 106.89 C-437.13 106.89, -437.13 106.89, -437.13 106.89" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g transform="translate(647.6519630043134 384.4355002506213) rotate(0 62.5 18)"><text x="62.5" y="14" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">when cacheLoad </text><text x="62.5" y="32" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">command is sent</text></g><g transform="translate(494.8784384096124 536.2826402427902) rotate(0 75.5 9)"><text x="75.5" y="14" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">valid cache response</text></g><g transform="translate(801.944172909026 130.66535318365806) rotate(0 42.5 18)"><text x="42.5" y="14" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">faulty cache</text><text x="42.5" y="32" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">response</text></g><g transform="translate(605.1168440694483 293.73446521080893) rotate(0 42 18)"><text x="42" y="14" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">redo cache </text><text x="42" y="32" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">response</text></g><g transform="translate(261.08848019005825 22.409388056389957) rotate(0 101 18)"><text x="101" y="14" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">the atomic instruction(store) </text><text x="101" y="32" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">is successfully written back</text></g><g transform="translate(490.59124377074056 229.58836961546154) rotate(0 112.5 18)"><text x="112.5" y="14" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">the atomic instruction(AMO op) </text><text x="112.5" y="32" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">is the next to be written back</text></g><g transform="translate(177.4176865821952 238.38511945445703) rotate(0 102.5 18)"><text x="102.5" y="14" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">the atomic instruction(SC) is </text><text x="102.5" y="32" font-family="Helvetica, Segoe UI Emoji" font-size="16px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">the next to be written back</text></g></svg>

- `IDLE`

We wait in this state until the atomic instruction is the next to be written back, if the instruction is :
- an atomic operation, we go to the `LOAD_CMD` state
- a store conditional, we go to the `ALU` state

As long as we are no longer in the `IDLE` state, a `lockPort` command is sent to the cache to lock the cache line pointed to by the atomic instruction.

- `LOAD_CMD`

We send a load command to the cache to load one of the operands, and when the command is sent, we go to the `LOAD_RSP` state.

- `LOAD_RSP`

We wait for the cache response.

When we receive it, the data received is written to the destination register. To write to the registry file, we pass through the `cacheRsp` stage of the `sharedPip` pipeline, in order to use the hardware it contains to shift and format the data. The `specialOverride` variable is set to true to preempt the registry file bus, and avoid collisions with the load currently in `cacheRsp`.

We check also if :
- it's a redo response (cache miss), we go back to the `LOAD_CMD` state, to resend the command
- it's a faulty response, we go to the `TRAP` state
- it's a valid response, we go to the `ALU` state

- `TRAP`

We send a trap command to the `CommitPlugin` with trap cause `STORE_ACCESS_FAULT`
We go back to the `IDLE` state.
  
- `ALU`

We store the `result` of the atomic operation of the ALU in a register used in `SYNC`.
The ALU performs the necessary operation between the data loaded from memory and data in the register provided by the instruction.
We go to the `COMPLETION` state.

- `COMPLETION`

We send `wakeRob`, `wakeRf` and `specialCompletion` signals, to signal that the instruction has been executed and the data is in the regfile.

For store conditional instructions, we write in the destination register :
- 0 if the store conditional was successful
- 1 if the store conditional has failed

We go then to the `SYNC` state.

- `SYNC`

As we sent a `specialCompletion` signal to the `RobPlugin`, the atomic instruction is committed by the `CommitPlugin`, and this begins the `writeback.feed` process.

If it's an atomic operation, we write the result stored in the `ALU` state to the cache.

If it's a store conditional instruction :
- if successful, we write the data supplied by this instruction
- if it has failed, we write nothing by setting `writeback.feed.skip = True`

Finally, we wait for the store queue entry to be released, which happens when the `writeback` process finishes.
During the wait, the `dispatch` stage of `frontend` pipeline is halted.

When it is released :
1. If it's a store conditional, we release the reservation by setting `lq.reservation.valid = False`
2. we set `fire` to true, to allow another atomic instruction to be processed
3. we go back to the `IDLE` state

___
#### rescheduling

When a rescheduling is performed :
- The load queue pointers `free` and `alloc` are reinitialised to 0, and all load queue entries are invalidated
- As a rescheduling occurs when pointing to the same address, a load instruction comes after a store instruction in the program order, but is processed first in `Lsu2`. The load instruction will load a wrong value. So we have to reschedule from the load to process it again.
  But when the load is processed, it needs to know which store instruction caused the collision, so all entries in the store queue are invalidated, except for the entry for that store instruction.
  In this way, the load can access the data in the store queue, if the data is not yet in cache.
- The `sq.ptr.alloc` pointer is also set to point to the store instruction that caused the collision. In this way, the load will check this instruction for the collision in `checkSqMask`.

